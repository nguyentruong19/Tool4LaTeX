# coding=utf-8
# src_provip.py
import re, os, sys, csv, codecs, time
from datetime import datetime, timedelta
from urllib.request import urlopen
import math, argparse, subprocess, signal, shutil, errno, unicodedata, webbrowser
from fractions import Fraction
from decimal import Decimal
from PyQt5 import QtCore, QtWidgets
from PyQt5.QtGui import *
from PyQt5.QtWidgets import *
from PyQt5.QtCore import *
from def_calculation import *
from src_reg import *
from def_bbt import *
from def_id import *
from def_convert import *
from def_ban_quyen import *
REG_INF = Registry_Inf_get()
DanhSachTinh = ['An Giang', 'Vũng Tàu', 'Bắc Giang', 'Bắc Kạn', 'Bạc Liêu', 'Bắc Ninh', 'Bến Tre', 'Bình Định', 'Bình Dương', 'Bình Phước', 'Bình Thuận', 'Cà Mau', 'Cần Thơ', 'Cao Bằng', 'Đà Nẵng', 'Đắk Lắk', 'Đắk Nông', 'Điện Biên', 'Đồng Nai', 'Đồng Tháp', 'Gia Lai', 'Hà Giang', 'Hà Nam', 'Hà Nội', 'Hà Tĩnh', 'Hải Dương', 'Hải Phòng', 'Hậu Giang', 'Hòa Bình', 'Hưng Yên', 'Khánh Hoà', 'Kiên Giang', 'Kon Tum', 'Lai Châu', 'Lâm Đồng', 'Lạng Sơn', 'Lào Cai', 'Long An', 'Nam Định', 'Nghệ An', 'Ninh Bình', 'Ninh Thuận', 'Phú Thọ', 'Phú Yên', 'Quảng Bình', 'Quảng Nam', 'Quảng Ngãi', 'Quảng Ninh', 'Quảng Trị', 'Sóc Trăng', 'Sơn La', 'Tây Ninh', 'Thái Bình', 'Thái Nguyên', 'Thanh Hoá', 'Thừa Thiên-Huế', 'Tiền Giang', 'TP. Hồ Chí Minh', 'Trà Vinh', 'Tuyên Quang', 'Vĩnh Long', 'Vĩnh Phúc', 'Yên Bái']

class ProVip(QWidget):

    def __init__(self, parent=None):
        QWidget.__init__(self, parent)
        self.setLayout(QGridLayout())
        self.group1 = QGroupBox('Tổng hợp file từ tổ viên (dành cho Tổ trưởng)')
        self.group1.vbox = QVBoxLayout()
        self.group1.hboxhd = QHBoxLayout()
        self.group1.check = QCheckBox('HD')
        self.group1.check.setChecked(True)
        self.group1.hd = QGroupBox('Hướng dẫn')
        self.group1.hboxhd.addWidget(self.group1.check)
        self.group1.hboxhd.addWidget(self.group1.hd)
        self.group1.hbox1 = QHBoxLayout()
        self.group1.label1 = QLabel('Chọn thư mục ')
        self.group1.label1.setMinimumWidth(30)
        self.group1.line1 = QLineEdit()
        self.group1.button1 = QPushButton('Chọn')
        self.group1.button1.clicked.connect(self.G1_get_file_1)
        self.group1.hbox1.addWidget(self.group1.label1)
        self.group1.hbox1.addWidget(self.group1.line1)
        self.group1.hbox1.addWidget(self.group1.button1)
        self.group1.hbox2 = QHBoxLayout()
        self.group1.labelNam = QLabel('Năm học ')
        self.group1.labelNam.setMinimumWidth(30)
        self.group1.comboNam = QComboBox()
        self.group1.comboNam.setStyleSheet("QComboBox { combobox-popup: 0; }")
        for i in range(2016, 2020):
            self.group1.comboNam.addItem(str(i) + '-' + str(i + 1))

        self.group1.comboNam.setCurrentIndex(2)
        self.group1.labelLop = QLabel(' Lớp ')
        self.group1.labelLop.setMinimumWidth(30)
        self.group1.comboLop = QComboBox()
        for i in range(10, 13):
            self.group1.comboLop.addItem(str(i))

        self.group1.comboLop.setCurrentIndex(2)
        self.group1.labelTinh = QLabel(' Tỉnh (TP) ')
        self.group1.labelTinh.setMinimumWidth(30)
        self.group1.comboTinh = QComboBox()
        self.group1.comboTinh.setStyleSheet("QComboBox { combobox-popup: 0; }")
        for i in DanhSachTinh:
            self.group1.comboTinh.addItem(str(i))

        self.group1.labelTruong = QLabel(' Trường THPT ')
        self.group1.labelTruong.setMinimumWidth(30)
        self.group1.comboTruong = QLineEdit()
        self.group1.hbox2.addWidget(self.group1.labelNam)
        self.group1.hbox2.addWidget(self.group1.comboNam)
        self.group1.hbox2.addWidget(self.group1.labelLop)
        self.group1.hbox2.addWidget(self.group1.comboLop)
        self.group1.hbox2.addWidget(self.group1.labelTinh)
        self.group1.hbox2.addWidget(self.group1.comboTinh)
        self.group1.hbox2.addWidget(self.group1.labelTruong)
        self.group1.hbox2.addWidget(self.group1.comboTruong)
        self.group1.hbox3 = QHBoxLayout()
        self.group1.labelKythi = QLabel('Tên kỳ thi ')
        self.group1.comboKythi = QComboBox()
        self.group1.comboKythi.addItem('Thi thử')
        self.group1.comboKythi.addItem('Giữa kì')
        self.group1.comboKythi.addItem('Học kì')
        self.group1.comboKythi.addItem('Đề số')
        self.group1.labelLan = QLabel(' Lần (kì, số) ')
        self.group1.comboLan = QComboBox()
        self.group1.comboLan.setStyleSheet("QComboBox { combobox-popup: 0; }")
        for i in range(1, 21):
            self.group1.comboLan.addItem(str(i))

        self.group1.labelThoigian = QLabel(' Thời gian ')
        self.group1.lineThoigian = QLineEdit('90')
        self.group1.lineThoigian.setMaximumWidth(30)
        self.group1.labelMade = QLabel(' Mã đề ')
        self.group1.lineMade = QLineEdit('108')
        self.group1.lineMade.setMaximumWidth(30)
        self.group1.labelTo = QLabel(' Tổ (Tác giả) ')
        self.group1.comboTo = QComboBox()
        self.group1.comboTo.setStyleSheet("QComboBox { combobox-popup: 0; }")
        self.group1.comboTo.addItem('Ngân hàng Offline')
        try:
            headfoot = codecs.open('Setting//header-footer.tex', 'r', 'utf-8').read()
            data = re.findall('\\\\lhead\\{(.*?)\\}\\s*\\\\chead\\{(.*?)\\}\\s*\\\\rhead\\{(.*?)\\}\\s*\\\\lfoot\\{(.*?)\\}\\s*\\\\cfoot\\{(.*?)\\}\\s*\\\\rfoot\\{(.*?)\\}', headfoot, re.DOTALL)
            self.group1.comboTo.addItem(data[0][2])
        except Exception as er:
            print(er)
            self.group1.comboTo.addItem('Phan Thanh Tâm')

        for i in range(1, 10):
            self.group1.comboTo.addItem('Tổ ' + str(i))

        self.group1.comboTo.currentIndexChanged.connect(self.comboToChange)
        self.group1.hbox3.addWidget(self.group1.labelKythi)
        self.group1.hbox3.addWidget(self.group1.comboKythi)
        self.group1.hbox3.addWidget(self.group1.labelLan)
        self.group1.hbox3.addWidget(self.group1.comboLan)
        self.group1.hbox3.addWidget(self.group1.labelThoigian)
        self.group1.hbox3.addWidget(self.group1.lineThoigian)
        self.group1.hbox3.addWidget(self.group1.labelMade)
        self.group1.hbox3.addWidget(self.group1.lineMade)
        self.group1.hbox3.addWidget(self.group1.labelTo)
        self.group1.hbox3.addWidget(self.group1.comboTo)
        self.group1.hbox4 = QHBoxLayout()
        self.group1.labelTen = QLabel(' Tên file ')
        self.group1.lineTen = QLineEdit()
        self.group1.hbox4.addWidget(self.group1.labelTen)
        self.group1.hbox4.addWidget(self.group1.lineTen)
        self.group1.hbox5 = QHBoxLayout()
        self.group1.button2 = QPushButton('Tạo Tên file')
        self.group1.button2.clicked.connect(self.G1_get_file_2)
        self.group1.button3 = QPushButton('Tổng hợp')
        self.group1.button3.clicked.connect(self.G1_get_file_3)
        self.group1.hbox5.addWidget(self.group1.button2)
        self.group1.hbox5.addWidget(self.group1.button3)
        self.group1.vbox.addItem(self.group1.hbox1)
        self.group1.vbox.addItem(self.group1.hbox2)
        self.group1.vbox.addItem(self.group1.hbox3)
        self.group1.vbox.addItem(self.group1.hbox4)
        self.group1.vbox.addItem(self.group1.hbox5)
        self.group1.setLayout(self.group1.vbox)
        self.group1.setMinimumHeight(100)
        self.group1.setMaximumHeight(200)
        self.group8 = QGroupBox('Update to be continue')
        self.layout().addWidget(self.group1)
        self.layout().addWidget(self.group8)

    def G1_get_file_1(self):
        fname = QFileDialog.getOpenFileNames()
        filename = ''
        for i in fname[0]:
            filename += i + ','

        self.group1.line1.setText(filename[:-1])

    def G1_get_file_2(self):
        if 1 == 1:
            Nam = self.group1.comboNam.currentText()[-2:]
            if 'Chuyên' in self.group1.comboTruong.text():
                Nam += 'C'
            Lop = self.group1.comboLop.currentText()[-1:]
            Tinh = self.group1.comboTinh.currentText()
            Tinh_new = strip_accents(Tinh).decode('utf-8')
            if Tinh_new == 'BaRia-VungTau':
                Tinh_new = 'VungTau'
            else:
                if Tinh_new == 'TP.HoChiMinh':
                    Tinh_new = 'SaiGon'
                else:
                    if Tinh_new == 'ThuaThien-Hue':
                        Tinh_new = 'Hue'
            Truong = strip_accents(self.group1.comboTruong.text()).decode('utf-8')
            Kythi = self.group1.comboKythi.currentText()
            if Kythi == 'Thi thử':
                Kt = 'L'
            else:
                if Kythi == 'Giữa kì':
                    Kt = 'G'
                else:
                    if Kythi == 'Học kì':
                        Kt = 'K'
                    else:
                        if Kythi == 'Đề số':
                            Kt = 'D'
            So = self.group1.comboLan.currentText()
            self.group1.lineTen.setText(Nam + '-' + Lop + '-' + Tinh_new + '-' + Truong + '-' + Kt + So)

    def G1_get_file_3(self):
        if 1 == 1:
            try:
                List = List_creat(self.group1.line1.text())
            except Exception as er:
                QMessageBox.question(self, 'Thông báo', 'Bạn chưa chọn file', QMessageBox.Yes)

            block = ''
            Folder = self.group1.line1.text()
            for filename in List:
                content, i = get_block_exbt(filename)
                block += content

            Tenfile = self.group1.lineTen.text()
            Nam = self.group1.comboNam.currentText()[-4:]
            Lop = self.group1.comboLop.currentText()[-1:]
            Truong = self.group1.comboTruong.text()
            Tinh = self.group1.comboTinh.currentText()
            Kythi = self.group1.comboKythi.currentText()
            So = self.group1.comboLan.currentText()
            if So == '1':
                Roman = 'I'
            if So == '2':
                Roman = 'II'
            if Kythi == 'Thi thử':
                TT = 'TT'
                Nhan = 'Đề thi thử THPT ' + Truong + ', ' + Tinh + ', lần ' + So + ' (' + Nam + ')'
                Tenkythi = 'Đề thi thử THPT Quốc Gia ' + Nam + ' -- Lần ' + So + '.'
            else:
                if Kythi == 'Giữa kì':
                    TT = 'GK' + So
                    Nhan = 'Đề thi GK' + Roman + ', THPT ' + Truong + ', ' + Tinh + ' (' + Nam + ')'
                    Tenkythi = 'Đề thi giữa học kì ' + Roman + '. Năm học ' + self.group1.comboNam.currentText() + '.'
                else:
                    if Kythi == 'Học kì':
                        TT = 'HK' + So
                        Nhan = 'Đề thi HK' + Roman + ', THPT ' + Truong + ', ' + Tinh + ' (' + Nam + ')'
                        Tenkythi = 'Đề thi học kì ' + Roman + '. Năm học ' + self.group1.comboNam.currentText() + '.'
                    else:
                        if Kythi == 'Đề số':
                            TT = 'TT'
                            Nhan = 'Đề số ' + So + ', THPT ' + Truong + ', ' + Tinh + ' (' + Nam + ')'
                            Tenkythi = 'Đề số ' + So + '. Năm học ' + self.group1.comboNam.currentText() + '.'
            main = '\\documentclass[12pt,a4paper]{article}\n%\\usepackage{fourier}\n\\usepackage[utf8]{vietnam}\n\\usepackage{amsmath,amssymb,yhmath,mathrsfs,fancyhdr,tkz-euclide,tikz-3dplot}\n\\usepackage{framed,tikz,tkz-tab,tkz-linknodes,pgfplots,currfile,enumerate}\n\\usetikzlibrary{shapes.geometric,arrows,calc,intersections,angles,patterns,snakes,shadings,quotes}\n\\usetkzobj{all}\n\\usepgfplotslibrary{fillbetween}\n\\pgfplotsset{compat=1.9}\n\\usepackage[top=1.5cm, bottom=1.5cm, left=1.5cm, right=1.5cm] {geometry}\n\\usepackage[hidelinks,unicode,pdfencoding=unicode, psdextra]{hyperref}\n\\usepackage[loigiai]{ex_test}\n\\renewcommand{\\vec}[1]{\\protect\\overrightarrow{#1}}\n\\newcommand{\\hoac}[1]{\\left[\\begin{aligned}#1\\end{aligned}\\right.}\n\\newcommand{\\heva}[1]{\\left\\{\\begin{aligned}#1\\end{aligned}\\right.}\n\\renewcommand{\\labelenumi}{\\alph{enumi})}\n\\usepackage{multirow}\n\\usepackage{makecell}\n\\usepackage{lastpage}\n\\renewcommand{\\baselinestretch}{1.2}\n% Format nhóm LaTeX\n\\usepackage{fancyhdr}\n\\pagestyle{fancy}\n\\lhead{\\color{blue!50!black} \\sc Dự án (2019)}\n\\rhead{\\color{blue!50!black}\\sc Nhóm \\LaTeX}\n\\lfoot{\\color{blue!50!black}\\href{https://www.facebook.com/groups/NganHangOffline/}{/groups/NganHangOffline/}}\n\\cfoot{}\n\\renewcommand{\\headrulewidth}{0.1pt}\n\\renewcommand{\\footrulewidth}{0.1pt}\n% Định nghĩa làm tiêu đề của gói dethi\n\\usepackage{refcount}\n\\newcommand{\\pagediff}[1]{%\n\t\\number\\numexpr\\getpagerefnumber{#1}-\\thepage+1\\relax}\n\\newcommand{\\@ttruong}{Sở GD\\&ĐT TP. Hồ Chí Minh}\n\\newcommand{\\@tkhoa}{THPT Trần Hưng Đạo}\n\\newcommand{\\@ldethi}{(Đề thi có \\@scau\\, câu/\\@strang\\, trang.)}\n\\newcommand{\\@tkythi}{Đề thi thử THPT Quốc Gia năm 2019}\n\\newcommand{\\@tmonhoc}{Môn Toán: 12.}\n\\newcommand{\\@tgian}{45}\n\\newcommand{\\@scau}{50}\n\\newcommand{\\@strang}{4}\n\\newcommand{\\@madethi}{Mã đề thi: 108}\n\\newcommand{\\@hovaten}{\\dotfill}\n\\newcommand{\\@sobaodanh}{\\dotfill}\n\\newcommand{\\tentruong}[1]{\\renewcommand{\\@ttruong}[1]{#1}}\n\\newcommand{\\tenkhoa}[1]{\\renewcommand{\\@tkhoa}{#1}}\n\\newcommand{\\loaidethi}[1]{\\renewcommand{\\@ldethi}{#1}}\n\\newcommand{\\tenkythi}[1]{\\renewcommand{\\@tkythi}{#1}}\n\\newcommand{\\tenmonhoc}[1]{\\renewcommand{\\@tmonhoc}{#1}}\n\\newcommand{\\thoigian}[1]{\\renewcommand{\\@tgian}{#1}}\n\\newcommand{\\socauhoi}[1]{\\renewcommand{\\@scau}{#1}}\n\\newcommand{\\sotrang}[1]{\\renewcommand{\\@strang}{#1}}\n\\newcommand{\\madethi}[1]{\\renewcommand{\\@madethi}{Mã đề thi: #1}}\n\\newcommand{\\hovaten}[1]{\\renewcommand{\\@hovaten}{\\color{red}#1}}\n\\newcommand{\\sobaodanh}[1]{\\renewcommand{\\@sobaodanh}{{\\color{red}#1}}}\n\\newcommand{\\lamtieude}{\n\\begin{minipage}[b]{0.35\\textwidth}\n\\centering\\textbf{\\@ttruong}\\\\\\textbf{\\@tkhoa}\\\\\\@ldethi\n\\end{minipage}\n\\hfill\n\\begin{minipage}[b]{0.65\\textwidth}\n\\centering\\textbf{\\@tkythi}\\\\\\textbf{\\@tmonhoc}\\\\\\underline{\\it Thời gian làm bài \\@tgian\\ phút.}\\\\\n\\end{minipage}\\vspace{3pt}\n\\begin{minipage}[b]{0.6\\textwidth}\n\\bf Họ và tên: \\@hovaten\n\\end{minipage}\n\\begin{minipage}[b]{0.4\\textwidth}\n\\bf SBD: \\@sobaodanh\\hfill\\fbox{\\@madethi}\n\\end{minipage}\n\\bigskip\n}\n\\rfoot{\\color{blue!50!black} Trang \\thepage/\\pageref{LastPage}\\, -- \\@madethi }% Ẩn hiện làm đáp án\n\\newcommand{\\hienda}{1}% 1: hiện đáp án, 0: không hiện đáp án\n\\ifthenelse{\\hienda=1}{\\newcommand{\\lamdapan}[1]{\n\\newpage\n\\begin{center}\n\\textbf{ĐÁP ÁN}\n\\end{center}\n\\begin{multicols}{10}\n\\input{#1}\n\\end{multicols}}}{\\newcommand{\\lamdapan}[1]{}}\n% Logo\n%\\usepackage[pages=all,placement=center]{background}\n%\\backgroundsetup{position={16cm,1.3cm},scale=1,color=black,opacity=0.2,angle=0,contents={\\centering{\\includegraphics[scale = 0.7]{LOGO}}}}\n\\renewtheorem{ex}{\\color{violet}Câu}\n\\newtheorem{bt}{\\color{violet}Bài}\n\\begin{document}\n\\input{' + TT + '/' + Tenfile + '.tex}\n\\end{document}\n'
            Tenthumuc = 'To' + self.group1.comboTo.currentText() + '-' + Tenfile
            try:
                os.makedirs('ProVip//' + Tenthumuc)
            except OSError as e:
                if e.errno != errno.EEXIST:
                    raise

            with codecs.open('ProVip//' + Tenthumuc + '//' + Tenfile + '-main.tex', 'w', 'utf8') as (f):
                f.write(main)
            try:
                os.makedirs('ProVip//' + Tenthumuc + '//' + TT)
            except OSError as e:
                if e.errno != errno.EEXIST:
                    raise

            line = ''
            line += '\\section{' + Nhan + '}\n'
            line += '\\tentruong{SỞ GD \\& ĐT ' + Tinh.upper() + '}\n'
            line += '\\tenkhoa{THPT ' + Truong + '}\n'
            line += '\\tenkythi{' + Tenkythi + '}\n'
            line += '\\tenmonhoc{Môn Toán ' + self.group1.comboLop.currentText() + '}\n'
            line += '\\thoigian{' + self.group1.lineThoigian.text() + '}\n'
            line += '\\madethi{' + self.group1.lineMade.text() + '}\n'
            line += '\\sotrang{\\pagediff{' + Tenfile + '}}\n'
            line += '\\hovaten{\\href{https://www.facebook.com/groups/NhomLaTeX/}{Nhóm \\LaTeX (groups/NhomLaTeX/)}}\n'
            line += '\\sobaodanh{\\sc ' + self.group1.comboTo.currentText() + '}\n\\lamtieude\n'
            line += '\\setcounter{ex}{0}\\setcounter{bt}{0}\n'
            line += '\\Opensolutionfile{ans}[ans/ans-' + Tenfile + ']\n'
            line += block
            line += '\\label{' + Tenfile + '}\n\\Closesolutionfile{ans}\n'
            line += '\\lamdapan{ans/ans-' + Tenfile + '}'
            ex_test = "\\ProvidesPackage{ex_test}[2018/07/29 for Ex_test version 2.4.3, Tran Anh Tuan]\n\\RequirePackage{ifthen}\n\\RequirePackage{fancyhdr}\n\\RequirePackage{multicol}\n\\RequirePackage{answers}\n\\RequirePackage{array}\n\\RequirePackage{multirow}\n\\RequirePackage{longtable}\n\\RequirePackage[utf8]{vietnam}\n\\RequirePackage{tikz}\n\\RequirePackage{ntheorem}\n\\RequirePackage{calc}\n\\RequirePackage{etoolbox}\n\\RequirePackage{probsoln}\n\\RequirePackage{picinpar}\n\\RequirePackage{filecontents}\n\\RequirePackage {expl3,xparse,epic,cntformats,xtemplate,environ}\n\n%Ẩn hiện công thức tự động\n\\newlength\\wsh\n\\newlength\\hsh\n\\newlength\\dsh\n\\newcommand{\\sh}[1]{%\n\\settowidth\\wsh{#1}%\n\\settoheight\\hsh{#1}%\n\\settodepth\\dsh{#1}%\n\\raisebox{0pt}[\\hsh][\\dsh]{\n\\rule{\\wsh}{0.1pt}}}\n\\newcommand{\\TF}[1]{\\EXboxTF{\\textbf{\\colorEX#1}}}\n\\newcommand{\\boxEX}[2][9pt]{%\n\\def\\sizeboxEX{#1}%\n\\setbox1=\\hbox{#2}%\n\\ \\EXbox{#2}\\ %\n}\n%Lệnh tagEX gán nhãn công thức thủ công\n\\newcommand{\\tagEX}[1]{%\n\\hfill{\\rm (#1)}%\n\\par\n\\@ifnextchar\\begin%\n{\\vspace{-\\baselineskip}}\n{}\n}\n%Đánh dấu phương án đúng\n\\newcommand{\\dapan}{Lệnh này giờ vô dụng}\n\\newcommand*\\circled[1]{\\tikz[baseline=(char.base)]{\n\\node[shape=circle,draw,inner sep=0.8pt] (char) {#1};}}\n\\newcommand*\\circEX[1]{\\tikz[baseline=(char.base)]{\\node[shape=circle,draw=red,inner sep=1pt] (char) {\\bf\\color{red} #1};}}\n\\newcommand*\\squareEX[1]{\\tikz[baseline=(char.base)]{\\node[shape=rectangle,draw=red,inner sep=2.5pt,fill=yellow!50] (char) {\\color{red} #1};}}\n\\newcounter{dapan}\n\\newcommand{\\TrueEX}{\\stepcounter{dapan}{{\\color{blue}\\circled{\\textbf{\\Alph{dapan}}}} \\ignorespaces}}\n\\newcommand{\\FalseEX}{\\stepcounter{dapan}{\\color{blue}\\circled{\\textbf{\\Alph{dapan}}} \\ignorespaces}}\n\\newlength\\widthalpha\n\\newlength\\widthalphaT\n\\newlength\\widthalphaF\n\\settowidth\\widthalphaT{\\TrueEX}\n\\settowidth\\widthalphaF{\\FalseEX}\n\\ifdim\\widthalpha<\\widthalphaT\\relax\\setlength{\\widthalpha}{\\widthalphaT}\\fi%\n\\ifdim\\widthalpha<\\widthalphaF\\relax\\setlength{\\widthalpha}{\\widthalphaF}\\fi%\n\\newcommand{\\begindapan}{\n\\@ifnextchar\\True\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\TrueEX\n\\end{minipage}\n\\begin{minipage}[t]{\\dorong}\n}\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{\\dorong}\n}\n}\n\\newcommand{\\begindapanhaiba}{\n\\@ifnextchar\\True\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\TrueEX\n\\end{minipage}\n\\begin{minipage}[t]{0.67\\dorong}\n}\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{0.67\\dorong}\n}\n}\n%Hiện Chọn đáp án trong lời giải chi tiết\n\\def\\selectA{\\par\\noindent Chọn đáp án \\circEX{A}}\n\\def\\selectB{\\par\\noindent Chọn đáp án \\circEX{B}}\n\\def\\selectC{\\par\\noindent Chọn đáp án \\circEX{C}}\n\\def\\selectD{\\par\\noindent Chọn đáp án \\circEX{D}}\n\\def\\selectE{\\par\\noindent Chọn đáp án \\circEX{E}}\n\\newcommand{\\hidetextchoice}{\n\\def\\selectA{}\n\\def\\selectB{}\n\\def\\selectC{}\n\\def\\selectD{}\n\\def\\selectE{}\n}\n\\newcommand{\\showtextchoice}{\n\\def\\selectA{\\par\\noindent Chọn đáp án \\circEX{A}}\n\\def\\selectB{\\par\\noindent Chọn đáp án \\circEX{B}}\n\\def\\selectC{\\par\\noindent Chọn đáp án \\circEX{C}}\n\\def\\selectD{\\par\\noindent Chọn đáp án \\circEX{D}}\n\\def\\selectE{\\par\\noindent Chọn đáp án \\circEX{E}}\n}\n%Tương thích môi trường enumerate,itemize\n\\def\\hfillEX{}\n\\BeforeBeginEnvironment{enumerate}\n{\\hfillEX}\n\\BeforeBeginEnvironment{itemize}\n{\\hfillEX}\n\\AtBeginEnvironment{multicols}\n{\\def\\hfillEX{}}\n\\newcommand{\\listenumerate}[1]{\n\\foreach \\xenumerate in {#1} {%môi trường\n\\AtBeginEnvironment{\\xenumerate}{\n\\def\\hfillEX{\\hfill}\n}\n\\AtEndEnvironment{\\xenumerate}{\n\\def\\hfillEX{}\n}\n}}\n\\listenumerate{ex}\n%Lời giải\n\\def\\loigiaiEX{\\color{blue} Lời giải.}\n%Danh sách môi trường hiện dòng kẻ trong lời giải\n\\newcommand{\\dotlineans}[2]{\n\\AtBeginEnvironment{#2}{\n\\def\\colorEX{}\n\\makeatletter\n\\renewcommand{\\begindapan}{\n\\@ifnextchar\\True\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{\\dorong}\n}\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{\\dorong}\n}\n}\n\\renewcommand{\\begindapanhaiba}{\n\\@ifnextchar\\True\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{0.67\\dorong}\n}\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{0.67\\dorong}\n}\n}\n\\makeatletter\n\\renewcommand{\\loigiai}[1]{\n\\dotlineEX{#1}\n}}}\n%Danh sách môi trường hiện dòng kẻ trong lời giải\n\\newcommand{\\showansEX}[1]{\n\\AtBeginEnvironment{#1}{\n\\makeatletter\n\\renewcommand{\\begindapan}{\n\\@ifnextchar\\True\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{\\dorong}\n}\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{\\dorong}\n}\n}\n\\renewcommand{\\begindapanhaiba}{\n\\@ifnextchar\\True\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{0.67\\dorong}\n}\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{0.67\\dorong}\n}\n}\n\\def\\True{\\setcounter{numTrue}{\\thedapan}\\setcounter{numTrueSol}{\\thedapan}}\n\\def\\loigiaiEX{\\color{blue} Lời giải.}\n\\showanswers\n%Xuất hiện chữ Lời giải trong môi trường onlysolution\n\\renewcommand{\\do@onlysolution}[1]{%\n\\par\\vspace{-0.1cm}\\noindent\\dotfill\\vspace{-0.1cm}\n\\par\\noindent\\textbf{\\loigiaiEX }\n\\ifshowanswers\n\\@ifnextchar\\immini\n{}\n{ \\@ifnextchar\\begin\n{}\n{\\par\\noindent}\n}\n##1%\n{}\n\\fi\n\\ifnum\\the\\value{numTrueSol}=1\n\\selectA\n\\fi\n\\ifnum\\the\\value{numTrueSol}=2\n\\selectB\n\\fi\n\\ifnum\\the\\value{numTrueSol}=3\n\\selectC\n\\fi\n\\ifnum\\the\\value{numTrueSol}=4\n\\selectD\n\\fi\n\\ifnum\\the\\value{numTrueSol}=5\n\\selectE \n\\fi\n\\setcounter{numTrueSol}{0}\n\\hfill\\qedEX\\noindent\\hrule\n}\n\\renewcommand{\\loigiai}[1]{\n\\labelex\n\\def\\labelex{}\n\\begin{onlysolution}\n##1\n\\end{onlysolution}\n}\n}}\n%Danh sách môi trường hiện dòng kẻ trong lời giải\n\\newcommand{\\hideansEX}[1]{\n\\AtBeginEnvironment{#1}{\n\\makeatletter\n\\renewcommand{\\begindapan}{\n\\@ifnextchar\\True\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{\\dorong}\n}\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{\\dorong}\n}\n}\n\\renewcommand{\\begindapanhaiba}{\n\\@ifnextchar\\True\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{0.67\\dorong}\n}\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{0.67\\dorong}\n}\n}\n\\def\\colorEX{}\n\\makeatletter\n\\renewcommand{\\begindapan}{\n\\@ifnextchar\\True\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{\\dorong}\n}\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{\\dorong}\n}\n}\n\\renewcommand{\\begindapanhaiba}{\n\\@ifnextchar\\True\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{0.67\\dorong}\n}\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{0.67\\dorong}\n}\n}\n\\renewenvironment{onlysolution}{%\n\\long@collect@body\\do@onlysolution\n}{}\n\\renewcommand{\\loigiai}[1]{\n}\n}}\n%Định nghĩa QED kết thúc chứng minh\n\\def\\qedEX{\\ensuremath{\\square}}\n%Đáp số câu hỏi tự luận\n\\Newassociation{solshort}{Solshort}{ansshort}\n\\renewcommand{\\Solshortlabel}[1]{\\color{violet}\\textbf{#1.}\n}\n\\newcommand{\\shortsolnum}[1]\n{\n\\renewenvironment{Solshort}[1]\n{\\begin{minipage}{\\linewidth/#1-1.2\\fboxsep}\n\\color{violet}\\textbf{##1.}\n\\color{black}\n}\n{\\end{minipage}}\n}\n\\newcommand{\\shortsol}[1]{\n\\scantokens{\n\\begin{solshort}\n#1\n\\end{solshort}}\n}\n%Trích dẫn nguồn\n\\def\\labelex{}\n\n\\newcommand{\\nameex}{Câu}\n%Dấu chấm, phảy sau mỗi phương án\n\\def\\dotEX{.}\n%Tương thích gói picinpar\n\\def\\picinpar{\\setlength{\\linewidth}{\\linewidth}}\n\\AtBeginEnvironment{window}{\\def\\picinpar{\\setlength{\\linewidth}{\\linewidth-\\picwd-\\lwindowsep-2\\fboxsep}}}\n%Tùy chọn lời giải\n\\newcommand{\\choicew}[1]{\\setlength{\\widthch}{#1}}\n\\newcommand{\\loigiai}[1]{\n\\begin{onlysolution}\n#1\n\\end{onlysolution}\n}\n\\def\\colorEX{\\color{red}}\n\\newcounter{numTrue}\n\\newcounter{numTrueSol}\n\\DeclareOption{solcolor}{\n\\renewcommand{\\TF}[1]{\\EXboxTF{\\textbf{\\colorEX#1}}}\n\\renewcommand{\\boxEX}[2][9pt]{%\n\\setbox1=\\hbox{#2}%\n\\def\\sizeboxEX{#1}%\n\\ \\EXbox{#2}\\ %\n}\n\\renewcommand{\\sh}[1]{#1}\n%\\renewcommand{\\TrueEX}{\\stepcounter{dapan}{\\squareEX{\\textbf{\\Alph{dapan}}}}}\n%\\renewcommand{\\FalseEX}{\\stepcounter{dapan}{\\circled{\\textbf{\\Alph{dapan}}}}}\n\\makeatletter\n\\renewcommand{\\begindapan}{\n\\@ifnextchar\\True\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\TrueEX\n\\end{minipage}\n\\begin{minipage}[t]{\\dorong}\n}\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{\\dorong}\n}\n}\n\\renewcommand{\\begindapanhaiba}{\n\\@ifnextchar\\True\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\TrueEX\n\\end{minipage}\n\\begin{minipage}[t]{0.67\\dorong}\n}\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{0.67\\dorong}\n}\n}\n\\def\\True{\\leavevmode\\colorEX\\setcounter{numTrue}{\\thedapan}\\setcounter{numTrueSol}{\\thedapan}}\n\\def\\loigiaiEX{\\color{blue} Lời giải.}\n\\showanswers\n%Xuất hiện chữ Lời giải trong môi trường onlysolution\n\\renewcommand{\\do@onlysolution}[1]{%\n\\par\\vspace{-0.1cm}\\noindent\\dotfill\\vspace{-0.1cm}\n\\par\\noindent\\textbf{\\loigiaiEX }\n\\ifshowanswers\n\\@ifnextchar\\immini\n{}\n{ \\@ifnextchar\\begin\n{}\n{\\par\\noindent}\n}\n#1%\n\\fi\n\\ifnum\\the\\value{numTrueSol}=1\n\\leavevmode\\unskip\\selectA\\ignorespaces\n\\fi\n\\ifnum\\the\\value{numTrueSol}=2\n\\leavevmode\\unskip\\selectB\\ignorespaces\n\\fi\n\\ifnum\\the\\value{numTrueSol}=3\n\\leavevmode\\unskip\\selectC\\ignorespaces\n\\fi\n\\ifnum\\the\\value{numTrueSol}=4\n\\leavevmode\\unskip\\selectD\\ignorespaces\n\\fi\n\\ifnum\\the\\value{numTrueSol}=5\n\\leavevmode\\unskip\\selectE\\ignorespaces\n\\fi\n\\setcounter{numTrueSol}{0}\n\\hfill\\qedEX\\noindent\\hrule\n{}\n}\n\\renewcommand{\\loigiai}[1]{\n\\labelex\n\\def\\labelex{}\n\\begin{onlysolution}\n#1\n\\end{onlysolution}\n}\n}\n\\DeclareOption{loigiai}{\n\\renewcommand{\\TF}[1]{\\EXboxTF{\\textbf{\\colorEX#1}}}\n\\renewcommand{\\boxEX}[2][9pt]{%\n\\setbox1=\\hbox{#2}%\n\\def\\sizeboxEX{#1}%\n\\ \\EXbox{#2}\\ %\n}\n\\renewcommand{\\sh}[1]{#1}\n%%\\renewcommand{\\FalseEX}{\\stepcounter{dapan}{\\color{blue}{\\bf \\Alph{dapan}}}.}\n\\makeatletter\n\\renewcommand{\\begindapan}{\n\\@ifnextchar\\True\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{\\dorong}\n}\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{\\dorong}\n}\n}\n\\renewcommand{\\begindapanhaiba}{\n\\@ifnextchar\\True\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{0.67\\dorong}\n}\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{0.67\\dorong}\n}\n}\n\\def\\True{\\setcounter{numTrue}{\\thedapan}\\setcounter{numTrueSol}{\\thedapan}}\n\\def\\loigiaiEX{\\color{blue} Lời giải.}\n\\showanswers\n%Xuất hiện chữ Lời giải trong môi trường onlysolution\n\\renewcommand{\\do@onlysolution}[1]{%\n\\par\\vspace{-0.1cm}\\noindent\\dotfill\\vspace{-0.1cm}\n\\par\\noindent\\textbf{\\loigiaiEX }\n\\ifshowanswers\n\\@ifnextchar\\immini\n{}\n{ \\@ifnextchar\\begin\n{}\n{\\par\\noindent}\n}\n#1%\n\\fi\n\\ifnum\\the\\value{numTrueSol}=1\n\\leavevmode\\unskip\\selectA\\ignorespaces\n\\fi\n\\ifnum\\the\\value{numTrueSol}=2\n\\leavevmode\\unskip\\selectB\\ignorespaces\n\\fi\n\\ifnum\\the\\value{numTrueSol}=3\n\\leavevmode\\unskip\\selectC\\ignorespaces\n\\fi\n\\ifnum\\the\\value{numTrueSol}=4\n\\leavevmode\\unskip\\selectD\\ignorespaces\n\\fi\n\\ifnum\\the\\value{numTrueSol}=5\n\\leavevmode\\unskip\\selectE\\ignorespaces\n\\fi\n\\setcounter{numTrueSol}{0}\n\\hfill\\qedEX\\noindent\\hrule\n{}\n}\n\\renewcommand{\\loigiai}[1]{\n\\labelex\n\\def\\labelex{}\n\\begin{onlysolution}\n#1\n\\end{onlysolution}\n}\n}\n\\DeclareOption{color}{\n%\\renewcommand{\\TrueEX}{\\stepcounter{dapan}{\\squareEX{\\textbf{\\Alph{dapan}}}}}\n%\\renewcommand{\\FalseEX}{\\stepcounter{dapan}{\\circled{\\textbf{\\Alph{dapan}}}}}\n\\makeatletter\n\\renewcommand{\\begindapan}{\n\\@ifnextchar\\True\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\TrueEX\n\\end{minipage}\n\\begin{minipage}[t]{\\dorong}\n}\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{\\dorong}\n}\n}\n\\renewcommand{\\begindapanhaiba}{\n\\@ifnextchar\\True\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\TrueEX\n\\end{minipage}\n\\begin{minipage}[t]{0.67\\dorong}\n}\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{0.67\\dorong}\n}\n}\n\\def\\colorEX{\\color{red}}\n\\def\\True{\\leavevmode\\colorEX\\setcounter{numTrue}{\\thedapan}\\setcounter{numTrueSol}{\\thedapan}}\n}\n\\DeclareOption{book}{\n%\\renewcommand{\\FalseEX}{\\stepcounter{dapan}{\\textbf{\\Alph{dapan}}}.}\n%\\renewcommand{\\TrueEX}{\\stepcounter{dapan}{\\textbf{\\Alph{dapan}}}.}\n\\makeatletter\n\\renewcommand{\\begindapan}{\n\\@ifnextchar\\True\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{\\dorong}\n}\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{\\dorong}\n}\n}\n\\renewcommand{\\begindapanhaiba}{\n\\@ifnextchar\\True\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{0.67\\dorong}\n}\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{0.67\\dorong}\n}\n}\n\\def\\loigiaiEX{\\color{blue} Lời giải.}\n\\showanswers\n\\makeatletter\n\\renewcommand{\\loigiai}[1]{\n\\labelex\n\\def\\labelex{}\n\\ifnum\\the\\value{numTrueSol}=1\n\\scantokens{\n\\begin{solbook}\n\\par\\noindent\n#1\n\\par\\noindent\n\\selectA\n\\hfill\\qedEX\n\\end{solbook}}\n\\fi\n\\ifnum\\the\\value{numTrueSol}=2\n\\scantokens{\n\\begin{solbook}\n\\par\\noindent\n#1\n\\par\\noindent\n\\selectB\n\\hfill\\qedEX\n\\end{solbook}}\n\\fi\n\\ifnum\\the\\value{numTrueSol}=3\n\\scantokens{\n\\begin{solbook}\n\\par\\noindent\n#1\n\\par\\noindent\n\\selectC\n\\hfill\\qedEX\n\\end{solbook}}\n\\fi\n\\ifnum\\the\\value{numTrueSol}=4\n\\scantokens{\n\\begin{solbook}\n\\par\\noindent\n#1\n\\par\\noindent\n\\selectD\n\\hfill\\qedEX\n\\end{solbook}}\n\\fi\n\\ifnum\\the\\value{numTrueSol}=5\n\\scantokens{\n\\begin{solbook}\n\\par\\noindent\n#1\n\\par\\noindent\n\\selectE\n\\hfill\\qedEX\n\\end{solbook}}\n\\fi\n\\ifnum\\the\\value{numTrueSol}=0\n\\scantokens{\n\\begin{solbook}\n\\par\\noindent\n#1\n\\hfill\\qedEX\n\\end{solbook}}\n\\fi\n\\setcounter{numTrueSol}{0}\n}\n\\def\\True{\\setcounter{numTrue}{\\thedapan}\\setcounter{numTrueSol}{\\thedapan}} \n}\n\\DeclareOption{dethi}{\n\\renewcommand{\\TF}[1]{\\EXboxTF{}}\n\\renewcommand{\\boxEX}[2][9pt]{%\n\\def\\sizeboxEX{#1}%\n\\setbox1=\\hbox{#2}%\n\\ \\EXbox{}\\ %\n}\n%\\renewcommand{\\FalseEX}{\\stepcounter{dapan}{\\textbf{\\Alph{dapan}}}.}\n\\makeatletter\n\\renewcommand{\\begindapan}{\n\\@ifnextchar\\True\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{\\dorong}\n}\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{\\dorong}\n}\n}\n\\renewcommand{\\begindapanhaiba}{\n\\@ifnextchar\\True\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{0.67\\dorong}\n}\n{\n\\begin{minipage}[h]{\\widthalpha}\n\\FalseEX\n\\end{minipage}\n\\begin{minipage}[t]{0.67\\dorong}\n}\n}\n\\def\\True{\\setcounter{numTrue}{\\thedapan}\\setcounter{numTrueSol}{\\thedapan}} \n}\n\\ExecuteOptions{dethi}\n\\ProcessOptions\n%Nội dung gói ex_test\n\\theorempreskipamount0.1\\baselineskip\n\\theorempostskipamount0.2\\baselineskip\n\\newlength\\dorongfix\n\\dorongfix=\\linewidth\n\\newlength\\dorong\n\\dorong=\\linewidth\n\\makeatletter\n\\newtheoremstyle{exbreak}%\n{\\item[\\hskip\\labelsep \\theorem@headerfont ##1\\ ##2\\theorem@separator]}%\n{\\item\\hbox to \\linewidth{\\theorem@headerfont ##1\\ ##2\\\n(##3)\\theorem@separator\\hfill}}\n\\newtheoremstyle{explain}%\n{\\item[\\hskip\\labelsep \\theorem@headerfont ##1\\ ##2\\theorem@separator]}%\n{\\item[\\hskip\\labelsep \\theorem@headerfont ##1\\ ##2\\theorem@separator]\\def\\labelex{\n\\begin{flushright}\n\\vspace*{-5pt}\n\\textit{\\textbf{(##3)}}\n\\vspace*{-5pt}\n\\end{flushright}}}\n%Danh sách môi trường trích dẫn nguồn câu hỏi\n\\newcommand{\\listtheorem}[1]{\n\\foreach \\x in {#1} {%môi trường\n\\AtEndEnvironment{\\x}{\n\\labelex\n}}}\n\\makeatother\n%\\theoremstyle{explain}\n\\theoremseparator{.}\n\\theorembodyfont{\\rm}\n\\Newassociation{solbook}{Solbook}{ansbook}\n\\renewcommand{\\Solbooklabel}[1]{\\textbf{\\nameex\\ #1.}\n}\n\\Newassociation{EXsol}{Solution}{ans}\n\\Newassociation{sol}{Solution}{ans_old}\n\\newtheorem{ex}{\\nameex}\n\\AtBeginEnvironment{Solbook}{\n\\renewcommand{\\IMleftright}[3]{\n\\par\\noindent\n\\begin{minipage}[t][][t]{\\linewidth-\\widthimmini-4\\fboxsep-#1\\linewidth}\n#2\n\\end{minipage}\n\\hspace{#1\\linewidth}\\hspace{2\\fboxsep}\n\\begin{minipage}[t][][b]{\\widthimmini}\\vspaceIM\n#3\n\\end{minipage}\n\\par\\nointerlineskip\n}\n}\n\\AtBeginEnvironment{ex}{\n\\setcounter{numTrueSol}{0}\n\\def\\dotEX{.}\n\\setcounter{numChoice}{0}\n}\n\\AtEndEnvironment{ex}{\n\\ifnum\\the\\value{numTrue}=1\n\\scantokens{\\begin{EXsol}A\\end{EXsol}}\n\\fi\n\\ifnum\\the\\value{numTrue}=2\n\\scantokens{\\begin{EXsol}B\\end{EXsol}}\n\\fi\n\\ifnum\\the\\value{numTrue}=3\n\\scantokens{\\begin{EXsol}C\\end{EXsol}}\n\\fi\n\\ifnum\\the\\value{numTrue}=4\n\\scantokens{\\begin{EXsol}D\\end{EXsol}}\n\\fi\n\\ifnum\\the\\value{numTrue}=5\n\\scantokens{\\begin{EXsol}E\\end{EXsol}}\n\\fi\n\\setcounter{numTrue}{0}\n\\setcounter{numTrueSol}{0}\n\\labelex\n}\n\\newtheorem{vdex}{Ví dụ}\n\\AtBeginEnvironment{vdex}{\\setcounter{numTrueSol}{0}\\def\\dotEX{.}}\n\\newcommand{\\boncot}[4]{\n\\picinpar\n\\setlength{\\dorong}{0.25\\linewidth-0.02\\dorongfix-\\widthalpha-2\\fboxsep}\n\\par\\setcounter{dapan}{0}\n\\noindent\\hspace{0.02\\dorongfix}\\begindapan\n#1\\dotEX\n\\end{minipage}\n\\noindent\\begindapan\n#2\\dotEX\n\\end{minipage}\n\\noindent\\begindapan\n#3\\dotEX\n\\end{minipage}\n\\noindent\\begindapan\n#4\\dotEX\n\\end{minipage}\n\n}\n\\newcommand{\\haicot}[4]{\n\\picinpar\n\\setlength{\\dorong}{0.5\\linewidth-0.02\\dorongfix-\\widthalpha-2\\fboxsep}\n\\par\\setcounter{dapan}{0}\n\\noindent\\hspace{0.02\\dorongfix}\\begindapan\n#1\\dotEX\n\\end{minipage}\n\\noindent\\begindapan\n#2\\dotEX\n\\end{minipage}\n\\par\\noindent\\hspace{0.02\\dorongfix}\\begindapan\n#3\\dotEX\n\\end{minipage}\n\\noindent\\begindapan\n#4\\dotEX\n\\end{minipage}\n\n}\n\\newcommand{\\motcot}[4]{\n\\picinpar\n\\setlength{\\dorong}{\\linewidth-0.02\\dorongfix-\\widthalpha-2\\fboxsep}\n\\par\\setcounter{dapan}{0}\n\\noindent\\hspace{0.02\\dorongfix}\\begindapan\n#1\\dotEX\\strut\n\\end{minipage}\n\n\\noindent\\hspace{0.02\\dorongfix}\\begindapan\n#2\\dotEX\\strut\n\\end{minipage}\n\n\\noindent\\hspace{0.02\\dorongfix}\\begindapan\n#3\\dotEX\\strut\n\\end{minipage}\n\n\\noindent\\hspace{0.02\\dorongfix}\\begindapan\n#4\\dotEX\\strut\n\\end{minipage}\n\n}\n%%%%%%%Tự động chọn \\motcot, \\haicot, \\boncot\n\\newlength\\widthcha\n\\newlength\\widthchb\n\\newlength\\widthchc\n\\newlength\\widthchd\n\\newlength\\widthche\n\\newlength\\widthch\n\\newlength\\tabmaxwidth\n\\newlength\\fourthtabwidth\n\\newlength\\halftabwidth\n\\newlength\\fifthtabwidth\n\\newlength\\thirdtabwidth\n\\newcommand{\\choice}[4]{%\n\\setlength\\tabmaxwidth{\\linewidth-0.02\\dorongfix-\\widthalpha-3\\fboxsep}\n\\setlength\\fourthtabwidth{0.25\\linewidth-0.02\\dorongfix-\\widthalpha-3\\fboxsep}\n\\setlength\\halftabwidth{0.5\\linewidth-0.02\\dorongfix-\\widthalpha-3\\fboxsep}\n\\settowidth\\widthcha{#1}\n\\ifdim\\widthch<\\widthcha\\relax\\setlength{\\widthch}{\\widthcha}\\fi%\n\\settowidth\\widthchb{#2}%\n\\ifdim\\widthch<\\widthchb\\relax\\setlength{\\widthch}{\\widthchb}\\fi%\n\\settowidth\\widthchc{#3}%\n\\ifdim\\widthch<\\widthchc\\relax\\setlength{\\widthch}{\\widthchc}\\fi%\n\\settowidth\\widthchd{#4}%\n\\ifdim\\widthch<\\widthchd\\relax\\setlength{\\widthch}{\\widthchd}\\fi%\n\\ifdim\\widthch<\\fourthtabwidth\n\\boncot{#1}{#2}{#3}{#4}\n\\else\\ifdim\\widthch<\\halftabwidth\n\\haicot{#1}{#2}{#3}{#4}\n\\else\n\\motcot{#1}{#2}{#3}{#4}\n\\fi\\fi\n}\n\\newcommand{\\choicefix}[4]{%\n\\setlength\\tabmaxwidth{\\linewidth-0.02\\dorongfix-\\widthalpha-3\\fboxsep}\n\\setlength\\fourthtabwidth{0.25\\linewidth-0.02\\dorongfix-\\widthalpha-3\\fboxsep}\n\\setlength\\halftabwidth{0.5\\linewidth-0.02\\dorongfix-\\widthalpha-3\\fboxsep}\n\\settowidth\\widthcha{#1}\n\\ifdim\\widthch<\\widthcha\\relax\\setlength{\\widthch}{\\widthcha}\\fi%\n\\settowidth\\widthchb{#2}%\n\\ifdim\\widthch<\\widthchb\\relax\\setlength{\\widthch}{\\widthchb}\\fi%\n\\settowidth\\widthchc{#3}%\n\\ifdim\\widthch<\\widthchc\\relax\\setlength{\\widthch}{\\widthchc}\\fi%\n\\settowidth\\widthchd{#4}%\n\\ifdim\\widthch<\\widthchd\\relax\\setlength{\\widthch}{\\widthchd}\\fi%\n\\ifdim\\widthch<\\fourthtabwidth\n\\boncot{#1}{#2}{#3}{#4}\n\\else\\ifdim\\widthch<\\halftabwidth\n\\haicot{#1}{#2}{#3}{#4}\n\\else\n\\motcot{#1}{#2}{#3}{#4}\n\\fi\\fi\n}\n%Trắc nghiệm 5 lựa chọn\n\\newcommand{\\nammot}[5]{\n\\picinpar\n\\setlength{\\dorong}{0.2\\linewidth-0.022\\dorongfix-2\\fboxsep-\\widthalpha}\n\\par\\setcounter{dapan}{0}\n\\noindent\\hspace{0.02\\dorongfix}\\begindapan\n#1\\dotEX\n\\end{minipage}\n\\noindent\\begindapan\n#2\\dotEX\n\\end{minipage}\n\\noindent\\begindapan\n#3\\dotEX\n\\end{minipage}\n\\noindent\\begindapan\n#4\\dotEX\n\\end{minipage}\n\\noindent\\begindapan\n#5\\dotEX\n\\end{minipage}\n\n}\n\\newcommand{\\bahai}[5]{\n\\picinpar\n\\setlength{\\dorong}{0.5\\linewidth-0.02\\dorongfix-\\fboxsep-3\\widthalpha}\n\\setcounter{dapan}{0}\n\\par\\noindent\\hspace{0.02\\dorongfix}\\begindapanhaiba\n#1\\dotEX\n\\end{minipage}\n\\noindent\\begindapanhaiba\n#2\\dotEX\n\\end{minipage}\n\\noindent\\begindapanhaiba\n#3\\dotEX\n\\end{minipage}\n\\par\\noindent\\hspace{0.02\\dorongfix}\\begindapan\n#4\\dotEX\n\\end{minipage}\n\\noindent\\begindapan\n#5\\dotEX\n\\end{minipage}\n\n}\n\n\\newcommand{\\haiba}[5]{\n\\picinpar\n\\setlength{\\dorong}{0.5\\linewidth-0.02\\dorongfix-\\fboxsep-3\\widthalpha}\n\\setcounter{dapan}{0}\n\\par\\noindent\\hspace{0.02\\dorongfix}\\begindapan\n#1\\dotEX\n\\end{minipage}\n\\noindent\\begindapan\n#2\\dotEX\n\\end{minipage}\n\\par\\noindent\\hspace{0.02\\dorongfix}\\begindapanhaiba\n#3\\dotEX\n\\end{minipage}\n\\noindent\\begindapanhaiba\n#4\\dotEX\n\\end{minipage}\n\\noindent\\begindapanhaiba\n#5\\dotEX\n\\end{minipage}\n\n}\n\\newcommand{\\motnam}[5]{\n\\picinpar\n\\setlength{\\dorong}{\\linewidth-0.02\\dorongfix-\\fboxsep-2\\widthalpha}\n\\par\\setcounter{dapan}{0}\n\\noindent\\hspace{0.02\\dorongfix}\\begindapan\n#1\\dotEX\\strut\n\\end{minipage}\n\\par\\noindent\\hspace{0.02\\dorongfix}\\begindapan\n#2\\dotEX\\strut\n\\end{minipage}\n\\par\\noindent\\hspace{0.02\\dorongfix}\\begindapan\n#3\\dotEX\\strut\n\\end{minipage}\n\\par\\noindent\\hspace{0.02\\dorongfix}\\begindapan\n#4\\dotEX\\strut\n\\end{minipage}\n\\par\\noindent\\hspace{0.02\\dorongfix}\\begindapan\n#5\\dotEX\\strut\n\\end{minipage}\n\n}\n\\newlength\\wmothai\n\\newlength\\wmothaiba\n\\newlength\\wmothaibabon\n\\newlength\\wbonnam\n\\newlength\\wbabonnam\n\\newlength\\whaibabonnam\n\\newcounter{numChoice}\n\\newcommand{\\choicefive}[5]{%\n\\setlength\\tabmaxwidth{\\linewidth-\\picwd-\\lwindowsep}\n\\setlength\\fourthtabwidth{0.25\\linewidth-0.25\\picwd-0.25\\lwindowsep-\\widthalpha}\n\\setlength\\halftabwidth{0.5\\linewidth-0.5\\picwd-0.5\\lwindowsep-\\widthalpha}\n\\setlength\\fifthtabwidth{0.2\\linewidth-0.2\\picwd-0.2\\lwindowsep-\\widthalpha}\n\\setlength\\thirdtabwidth{0.33\\linewidth-0.33\\picwd-0.33\\lwindowsep-\\widthalpha}\n\\settowidth\\widthcha{AM.#1}\n\\ifdim\\widthch<\\widthcha\\relax\\setlength{\\widthch}{\\widthcha}\\fi%\n\\ifdim\\wmothai<\\widthcha\\relax\\setlength{\\wmothai}{\\widthcha}\\fi%\n\\ifdim\\wmothaiba<\\widthcha\\relax\\setlength{\\wmothaiba}{\\widthcha}\\fi%\n\\ifdim\\wmothaibabon<\\widthcha\\relax\\setlength{\\wmothaibabon}{\\widthcha}\\fi%\n\\settowidth\\widthchb{BM.#2}%\n\\ifdim\\widthch<\\widthchb\\relax\\setlength{\\widthch}{\\widthchb}\\fi%\n\\ifdim\\wmothai<\\widthchb\\relax\\setlength{\\wmothai}{\\widthchb}\\fi%\n\\ifdim\\wmothaiba<\\widthchb\\relax\\setlength{\\wmothaiba}{\\widthchb}\\fi%\n\\ifdim\\wmothaibabon<\\widthchb\\relax\\setlength{\\wmothaibabon}{\\widthchb}\n\\fi%\n\\ifdim\\whaibabonnam<\\widthchb\\relax\\setlength{\\whaibabonnam}{\\widthchb}\n\\fi%\n\\settowidth\\widthchc{CM.#3}%\n\\ifdim\\widthch<\\widthchc\\relax\\setlength{\\widthch}{\\widthchc}\\fi%\n\\ifdim\\wmothaiba<\\widthchc\\relax\\setlength{\\wmothaiba}{\\widthchc}\\fi%\n\\ifdim\\wmothaibabon<\\widthchc\\relax\\setlength{\\wmothaibabon}{\\widthchc}\\fi%\n\\ifdim\\wbabonnam<\\widthchc\\relax\\setlength{\\wbabonnam}{\\widthchc}\\fi%\n\\ifdim\\whaibabonnam<\\widthchc\\relax\\setlength{\\whaibabonnam}{\\widthchc}\n\\fi%\n\\settowidth\\widthchd{DM.#4}%\n\\ifdim\\widthch<\\widthchd\\relax\\setlength{\\widthch}{\\widthchd}\\fi%\n\\ifdim\\wmothaibabon<\\widthchd\\relax\\setlength{\\wmothaibabon}{\\widthchd}\\fi%\n\\ifdim\\wbabonnam<\\widthchd\\relax\\setlength{\\wbabonnam}{\\widthchd}\\fi%\n\\ifdim\\wbonnam<\\widthchd\\relax\\setlength{\\wbonnam}{\\widthchd}\\fi%\n\\ifdim\\whaibabonnam<\\widthchd\\relax\\setlength{\\whaibabonnam}{\\widthchd}\n\\fi%\n\\settowidth\\widthche{EM.#5}%\n\\ifdim\\widthch<\\widthche\\relax\\setlength{\\widthch}{\\widthche}\\fi%\n\\ifdim\\wbabonnam<\\widthche\\relax\\setlength{\\wbabonnam}{\\widthche}\\fi%\n\\ifdim\\wbonnam<\\widthche\\relax\\setlength{\\wbonnam}{\\widthche}\\fi%\n\\ifdim\\whaibabonnam<\\widthchd\\relax\\setlength{\\whaibabonnam}{\\widthchd}\n\\fi%\n%Khởi tạo điều kiện \n\\setcounter{numChoice}{0}\n\\ifdim\\wmothai<\\halftabwidth\n\\ifdim\\wbabonnam<\\thirdtabwidth \n\\setcounter{numChoice}{1}\n\\fi\\fi\n\\ifdim\\wmothaiba<\\thirdtabwidth \n\\ifdim\\wbonnam<\\halftabwidth\n\\setcounter{numChoice}{2}\n\\fi\\fi\n\\ifdim\\widthch<\\fifthtabwidth\n\\setcounter{numChoice}{3}\n\\fi\n%Lựa chọn cách sắp xếp\n\\ifnum\\the\\value{numChoice}=3\n\\nammot{#1}{#2}{#3}{#4}{#5}\n\\else\n\\ifnum\\the\\value{numChoice}=2\n\\bahai{#1}{#2}{#3}{#4}{#5}\n\\else\n\\ifnum\\the\\value{numChoice}=1\n\\haiba{#1}{#2}{#3}{#4}{#5}\n\\else\n\\motnam{#1}{#2}{#3}{#4}{#5}\n\\fi\\fi\\fi\n}\n%HẾT trắc nghiệm 5 lựa chọn\n%Các phương pháp đưa hình vào văn bản\n\\def\\vspaceIM{\\vspace{-13pt}}\n\\def\\breakIM{}\n\\def\\numpicinpar{0}\n\\newdimen\\widthimmini\n\\newdimen\\heightimmini\n\\newdimen\\spaceleft\n\\newbox\\imbox\n\\newcommand{\\hspaceIM}[1]{\n\\def\\hspaceIMEX{\\hspace{#1\\linewidth}}\n\\def\\hspaceEXIM{#1\\linewidth}\n}\n\\newcommand{\\IMleftright}[3]{\n\\hfill\\par\\noindent\n\\begin{minipage}[t][][t]{\\linewidth-\\widthimmini-4\\fboxsep-#1\\linewidth}\n#2\n\\end{minipage}\n\\hspace{#1\\linewidth}\\hspace{2\\fboxsep}\n\\begin{minipage}[t][][b]{\\widthimmini}\\vspaceIM\n#3\n\\end{minipage}\n\\par\\nointerlineskip\n}\n\\newcommand{\\immini}[3][0]{\n\\setbox\\imbox=\\vbox{\\hbox{#3}}\n\\widthimmini=\\wd\\imbox\n\\heightimmini=\\ht\\imbox\n\\spaceleft=\\dimexpr\\textheight-\\pagetotal-2\\baselineskip\\relax\n\\ifdim\\heightimmini>\\spaceleft\n\\breakIM\n\\fi\n\\IMleftright{#1}{#2}{#3}\n}\n\\newcommand{\\impicinpar}[2]{\n\\begin{window}[\\numpicinpar,r,{\n#2\n}, {}]\n\\begin{flushleft}\n#1\n\\end{flushleft}\n\\end{window}\n}\n%Hết cách đưa hình vào văn bản\n\n% Biểu diễn khoảng, đoạn trên trục số\n\\usetikzlibrary{decorations.pathreplacing,decorations.markings,patterns}\n\\def\\colorInterval{black}\n\\def\\skipInterval{0.4cm}\n\\newcommand{\\Interval}[4]{%\n\\coordinate [label={center:$#1$},label=below:$\\rule{0pt}{\\skipInterval}#2$] (a) at (#2,0); \n\\coordinate [label={center:$#3$},label=below:$\\rule{0pt}{\\skipInterval}#4$] (b) at (#4,0); \n\\draw[color=\\colorInterval] decorate[decoration={ticks,amplitude=3pt,segment length=1mm}] {(a)--(b)};\n}\n\\newcommand{\\IntervalR}[4]{%\n\\coordinate [label={center:$#1$},label=below:$\\rule{0pt}{\\skipInterval}#2$] (a) at (#2,0); \n\\coordinate [label={center:$#3$},label=below:$\\rule{0pt}{\\skipInterval}#4$] (b) at (#4,0); \n\\draw decorate[decoration={markings,mark=% actually add a mark\nbetween positions 0 and 1 step 1mm\nwith\n{\n\\draw[color=\\colorInterval] (-3pt,-3pt) -- (3pt,3pt);\n}}] {(a)--(b)};\n}\n\\newcommand{\\IntervalL}[4]{%\n\\coordinate [label={center:$#1$},label=below:$\\rule{0pt}{\\skipInterval}#2$] (a) at (#2,0); \n\\coordinate [label={center:$#3$},label=below:$\\rule{0pt}{\\skipInterval}#4$] (b) at (#4,0); \n\\draw decorate[decoration={\nmarkings,\nmark=between positions 0 and 1 step 1mm\nwith\n{\n\\draw[color=\\colorInterval] (-3pt,3pt) -- (3pt,-3pt);\n}\n}\n] {(a)--(b)};\n}\n\\newcommand{\\IntervalLF}[4]{%\n\\coordinate [label={center:$#1$},label=below:$\\rule{0pt}{\\skipInterval}#2$] (a) at (#2,0); \n\\coordinate [label={center:$#3$},label=below:$\\rule{0pt}{\\skipInterval}#4$] (b) at (#4,0); \n\\fill[pattern=north west lines,pattern color=\\colorInterval](#2,-3pt)rectangle(#4,3pt);\n}\n\\newcommand{\\IntervalRF}[4]{%\n\\coordinate [label={center:$#1$},label=below:$\\rule{0pt}{\\skipInterval}#2$] (a) at (#2,0); \n\\coordinate [label={center:$#3$},label=below:$\\rule{0pt}{\\skipInterval}#4$] (b) at (#4,0); \n\\fill[pattern=north east lines,pattern color=\\colorInterval](#2,-3pt)rectangle(#4,3pt);\n}\n\\def\\pre{0}\n\\def\\next{2}\n\\newcommand{\\IntervalLR}[2]{\n\\def\\pre{#1}\n\\def\\next{#2}\n}\n\\newcommand{\\IntervalG}[4]{%\n\\coordinate [label={center:$#1$},label=below:$\\rule{0pt}{\\skipInterval}#2$] (a) at (\\pre,0); \n\\coordinate [label={center:$#3$},label=below:$\\rule{0pt}{\\skipInterval}#4$] (b) at (\\next,0); \n\\draw[color=\\colorInterval] decorate[decoration={ticks,amplitude=3pt,segment length=1mm}] {(a)--(b)};\n}\n\\newcommand{\\IntervalGL}[4]{%\n\\coordinate [label={center:$#1$},label=below:$\\rule{0pt}{\\skipInterval}#2$] (a) at (\\pre,0); \n\\coordinate [label={center:$#3$},label=below:$\\rule{0pt}{\\skipInterval}#4$] (b) at (\\next,0); \n\\draw decorate[decoration={markings,mark=% actually add a mark\nbetween positions 0 and 1 step 1mm\nwith\n{\n\\draw[color=\\colorInterval] (-3pt,3pt) -- (3pt,-3pt);\n}}] {(a)--(b)};\n}\n\\newcommand{\\IntervalGR}[4]{%\n\\coordinate [label={center:$#1$},label=below:$\\rule{0pt}{\\skipInterval}#2$] (a) at (\\pre,0); \n\\coordinate [label={center:$#3$},label=below:$\\rule{0pt}{\\skipInterval}#4$] (b) at (\\next,0); \n\\draw decorate[decoration={markings,mark=% actually add a mark\nbetween positions 0 and 1 step 1mm\nwith\n{\n\\draw[color=\\colorInterval] (-3pt,-3pt) -- (3pt,3pt);\n}}] {(a)--(b)};\n}\n\n\\newcommand{\\IntervalGLF}[4]{%\n\\coordinate [label={center:$#1$},label=below:$\\rule{0pt}{\\skipInterval}#2$] (a) at (\\pre,0); \n\\coordinate [label={center:$#3$},label=below:$\\rule{0pt}{\\skipInterval}#4$] (b) at (\\next,0); \n\\fill[pattern=north west lines,pattern color=\\colorInterval](\\pre,-3pt)rectangle(\\next,3pt);\n}\n\\newcommand{\\IntervalGRF}[4]{%\n\\coordinate [label={center:$#1$},label=below:$\\rule{0pt}{\\skipInterval}#2$] (a) at (\\pre,0); \n\\coordinate [label={center:$#3$},label=below:$\\rule{0pt}{\\skipInterval}#4$] (b) at (\\next,0); \n\\fill[pattern=north east lines,pattern color=\\colorInterval](\\pre,-3pt)rectangle(\\next,3pt);\n}\n%Định nghĩa dots fill\n\\newcommand{\\dotlineEX}[1]{\n\\def\\numlinedot{#1}\n\\par\n\\foreach \\dotline in{1,...,\\numlinedot}\n{\n\\noindent\\dotfill\n\\par\n}\n}\n%Liệt kê danh sách đáp án\n\\newsavebox{\\myboxans}\n\\newcommand{\\boxans}\n{\n\\renewenvironment{Solution}[1]\n{\\begin{lrbox}{\\myboxans}\\begin{minipage}{0.1\\linewidth-4\\fboxsep}\n\\parbox[b]{0.55\\linewidth}{\\color{blue}##1.}\n\\color{violet}\n}\n{\\end{minipage}\\end{lrbox}\\fbox{\\usebox{\\myboxans}}}\n}\n\\newcommand{\\listans}\n{\n\\renewenvironment{Solution}[1]\n{{\\color{blue}##1}\\hspace*{-4pt}}\n{\\hspace*{-5pt}}\n}\n\\newcommand{\\tabans}[1]\n{\n\\renewenvironment{Solution}[1]\n{\\begin{minipage}{\\linewidth/#1-1.2\\fboxsep}\n\\parbox[b]{0.45\\linewidth}{\n\\raggedleft\\color{blue}##1.\n}\n\\color{violet}\n}\n{\\end{minipage}}\n}\n\\newcommand{\\rowans}\n{\n\\renewenvironment{Solution}[1]\n{\\begin{minipage}{0.1\\linewidth-1.2\\fboxsep}\n\\parbox[b]{0.45\\linewidth}{\n\\raggedleft\\color{blue}##1.\n}\n\\color{violet}\n}\n{\\end{minipage}}\n}\n\\newcommand{\\inputans}[2]{\n\\renewenvironment{Solution}[1]\n{\\begin{minipage}{\\linewidth/#1-1.2\\fboxsep}\n\\parbox[b]{0.45\\linewidth}{\n\\raggedleft\\color{blue}##1.\n}\n\\color{violet}\n}\n{\\end{minipage}}\n\\begin{flushleft}\n\\input{#2} \n\\end{flushleft}\n}\n\\newcommand{\\inputansbox}[2]{\n\\renewenvironment{Solution}[1]\n{\\begin{lrbox}{\\myboxans}\\begin{minipage}{\\linewidth/#1-4\\fboxsep}\n\\parbox[b]{0.55\\linewidth}{\\color{blue}##1.}\n\\color{violet}\n}\n{\\end{minipage}\\end{lrbox}\\fbox{\\usebox{\\myboxans}}}\n\\begin{flushleft}\n\\input{#2} \n\\end{flushleft}\n}\n\\makeatletter\n\\@ifclasswith{article}{a5paper}\n{%\n\\renewcommand{\\rowans}\n{\n\\renewenvironment{Solution}[1]\n{\\begin{minipage}{0.2\\linewidth-1.2\\fboxsep}\n\\parbox[b]{0.45\\linewidth}{\\color{blue}##1.}\n\\color{violet}\n}\n{\\end{minipage}}\n}\n}{%\n}\n\\@ifclasswith{book}{a5paper}\n{%\n\\renewcommand{\\rowans}\n{\n\\renewenvironment{Solution}[1]\n{\\begin{minipage}{0.2\\linewidth-1.2\\fboxsep}\n\\parbox[b]{0.45\\linewidth}{\\color{blue}##1.}\n\\color{violet}\n}\n{\\end{minipage}}\n}\n}{%\n}\n\\makeatother\n%Hỗ trợ gói ex_test_rd\n\\newenvironment{fileEX}{\\filecontents}{\\endfilecontents}\n\\newcommand{\\bankEX}[2]{\n\\input{#1}\n}\n\\newtheorem{exrd}{Câu}\n\\def\\listfile{\n\\bankEX{onefile.tex}{50}\n}\n\\def\\testname{\n\\begin{center}\n\\textbf{ĐỀ THI MẪU}\n\\end{center}\n\\rightline{\n\\setlength\\fboxrule{2pt} \n\\setlength\\fboxsep{5pt} \n\\fbox{\\textbf{Mã đề thi\\ \\x}}\n}\n}\n\\newcommand{\\randombank}[1]{\n%\\testname\n\\begin{center}\n\\textbf{\n\\color{red}\nBạn đang chạy bằng gói ex\\_test xuất ra MỌI CÂU HỎI của ngân hàng nhằm soát lỗi.\\\\\nKhi mọi thứ đã OK, hãy thay khai báo gói ex\\_test bằng gói ex\\_test\\_rd\n}\n\\end{center}\n\\Opensolutionfile{ans}[ans/ans_ex_test]\n\\listfile\n\\Closesolutionfile{ans}\n}\n\\newcommand{\\showansfull}{\\par Các mã đề: }\n\\newcommand{\\showans}{\\par Các mã đề: }\n%Đường tròn LG\n\\usetikzlibrary{plotmarks}\n\\newcommand{\\trucLG}{\n\\draw[->] (0,-1.3) -- (0,1.3) node[left] {$\\sin$};\n\\draw[->] (-1.3,0) -- (1.3,0) node[below] {$\\cos$};\n\\draw (0,0) circle (1cm);\n}\n\\newcommand{\\pointLG}[4]\n{\n\\foreach \\i in {0,...,#2}\n{\n\\draw[color=#4]\nplot[mark=#3] coordinates {({#1+\\i*360/#2}:1)};\n}\n}\n\\makeatletter\n\\def\\sizeboxEX{9pt}\n\\def\\EXbox#1{%\n\\begingroup%\n\\setlength{\\fboxsep}{0.3ex}%\n\\setlength{\\@tempdima}{\\sizeboxEX}%\n\\setlength{\\@tempdimb}{(\\@tempdima-\\ht1+\\dp1)/2}%\n\\raise-\\@tempdimb\\hbox{\\fbox{\\vbox to \\@tempdima{%\n\\vfil\\hbox to \\@tempdima{\\hfil#1\\hfil}\\vfil}}}%\n\\endgroup%\n}\n\\def\\EXboxTF#1{%\n\\begingroup%\n\\setlength{\\fboxsep}{0.3ex}%\n\\setbox1=\\hbox{#1}%\n\\setlength{\\@tempdima}{\\sizeboxEX}%\n\\fbox{\\vbox to \\@tempdima{%\n\\vfil\\hbox to \\@tempdima{\\hfil\\copy1\\hfil}\\vfil}}%\n\\endgroup%\n}\n\\makeatother\n% Môi trường liệt kê dàn theo nhiều dòng khác nhau\n\\ExplSyntaxOn\n% variants of kernel functions:\n\\cs_generate_variant:Nn \\tl_if_eq:nnTF { V }\n\\cs_generate_variant:Nn \\tl_if_eq:nnT { V }\n\n% --------------------------------------------------------------------------\n% variables:\n\\seq_new:N \\l__listsEX_seq\n\n\\int_new:N \\l__listsEX_depth_int\n\\int_new:N \\g__listsEX_int\n\\int_new:N \\g__listsEX_total_items_int\n\\int_new:N \\l__listsEX_columns_int\n\\int_new:N \\l__listsEX_rows_int\n\\int_new:N \\g__listsEX_current_col_num_int\n\\int_new:N \\g__listsEX_current_row_num_int\n\\int_new:N \\l__listsEX_item_columns_int\n\n\\bool_new:N \\l__listsEX_enumerate_bool\n\\bool_new:N \\l__listsEX_resume_bool\n\\bool_new:N \\l__listsEX_load_listsEX_bool\n\\bool_new:N \\l__listsEX_label_width_bool\n\\bool_new:N \\l__listsEX_item_indent_bool\n\\bool_new:N \\l__listsEX_label_offset_bool\n\\bool_new:N \\l__listsEX_custom_label_bool\n\\bool_new:N \\l__listsEX_custom_after_item_skip_bool\n\\bool_new:N \\l__listsEX_debug_bool\n\\bool_new:N \\l__listsEX_item_full_line_bool\n\\bool_new:N \\l__listsEX_item_rest_of_line_bool\n\n\\tl_new:N \\l__listsEX_instance_tl\n\\tl_new:N \\l__listsEX_label_tl\n\\tl_new:N \\l__listsEX_custom_label_tl\n\\tl_new:N \\l__listsEX_label_pattern_tl\n\\tl_new:N \\l__listsEX_custom_label_pattern_tl\n\\tl_new:N \\l__listsEX_label_format_tl\n\\tl_new:N \\l__listsEX_custom_label_format_tl\n\\tl_new:N \\l__listsEX_item_format_tl\n\\tl_new:N \\l__listsEX_custom_item_format_tl\n\\tl_new:N \\l__listsEX_item_fill_left_tl\n\\tl_new:N \\l__listsEX_item_fill_right_tl\n\\tl_new:N \\l__listsEX_label_align_tl\n% \\tl_new:N \\listEX\n\\tl_new:N \\l__listsEX_item_tl\n\\tl_new:N \\l__listsEX_tmp_label_tl\n\n\\dim_new:N \\l__listsEX_item_indent_dim\n\\dim_new:N \\l__listsEX_item_default_indent_dim\n\\dim_new:N \\l__listsEX_item_width_dim\n\\dim_new:N \\l__listsEX_label_width_dim\n\\dim_new:N \\l__listsEX_label_default_width_dim\n\\dim_new:N \\l__listsEX_label_offset_dim\n\\dim_new:N \\l__listsEX_label_default_offset_dim\n\\dim_new:N \\l__listsEX_column_sep_dim\n\n\\skip_new:N \\l__listsEX_after_item_skip\n\\skip_new:N \\l__listsEX_custom_after_item_skip\n\\skip_new:N \\l__listsEX_before_list_skip\n\\skip_new:N \\l__listsEX_after_list_skip\n\n\\coffin_new:N \\l__listsEX_item_coffin\n\\coffin_new:N \\l__listsEX_label_coffin\n\n\\NewCounterPattern* [ listsEX ] { listEX } { tsk }\n\\ReadCounterFrom [ listsEX ] { listEX } \\g__listsEX_int\n\n% temporary variables:\n\\int_new:N \\l__listsEX_tmpa_int\n\\int_new:N \\l__listsEX_tmpb_int\n\\tl_new:N \\l__listsEX_tmpa_tl\n\\coffin_new:N \\l__listsEX_tmpa_coffin\n\n\\cs_new:Npn \\__listsEX_debug:n #1\n{\n\\bool_if:NTF \\l__listsEX_debug_bool\n{ \\fbox {#1} }\n{ \\use:n {#1} }\n}\n\n% --------------------------------------------------------------------------\n% collect the listsEX:\n\\cs_new_protected:Npn \\__listsEX_collect_listsEX:nww #1#2 \\end #3\n{\n\\tl_put_right:Nn \\l__listsEX_body_tl {#1}\n\\end {#3}\n\\tl_if_eq:nnF {#1} {#3}\n{ \\__listsEX_collect_listsEX:nww {#1} }\n}\n\n% #1: instance\n% #2: number of columns\n% #3: item separator\n% #4: environment body\n\\cs_new_protected:Npn \\__listsEX:nnnn #1#2#3#4\n{\n\\bool_if:NT \\l__listsEX_debug_bool { \\dim_set:Nn \\fboxsep {0pt} }\n\\seq_set_split:Nnn \\l__listsEX_seq {#3} {#4}\n% remove the first (empty) item:\n\\seq_pop_left:NN \\l__listsEX_seq \\l__listsEX_tmpa_tl\n\\tl_if_blank:VF \\l__listsEX_tmpa_tl { \\@noitemerr }\n\\int_gset:Nn \\g__listsEX_total_items_int\n{ \\seq_count:N \\l__listsEX_seq }\n\\UseInstance {listsEX} {#1}\n{ \\g__listsEX_total_items_int }\n{#2}\n{ \\l__listsEX_custom_label_pattern_tl }\n% just to be sure:\n\\seq_clear:N \\l__listsEX_seq\n}\n\\cs_generate_variant:Nn \\__listsEX:nnnn { VnnV }\n\n% #1: label\n% #2: item format\n% #3: item\n\\cs_new_protected:Npn \\__listsEX_listEX:nnn #1#2#3\n{\n% start a new item line if \\l__listsEX_item_full_line_bool\n\\bool_if:NT \\l__listsEX_item_full_line_bool\n{\n% add skip if we were in the middle of a line, i.e., in horizontal\n% mode:\n\\mode_if_horizontal:T\n{ \\skip_vertical:N \\l__listsEX_after_item_skip }\n\\listsEX_new_row:\n}\n% step column position:\n\\int_gincr:N \\g__listsEX_current_col_num_int\n\\dim_set:Nn \\l__listsEX_item_width_dim\n{\n\\bool_if:NTF \\l__listsEX_item_full_line_bool\n{ \\linewidth }\n{\n(\n\\linewidth\n-\\fboxsep \n- \\l__listsEX_columns_int \\l__listsEX_column_sep_dim\n+ \\l__listsEX_column_sep_dim\n) / \\l__listsEX_columns_int\n}\n- \\l__listsEX_depth_int \\l__listsEX_item_indent_dim\n\\bool_if:NT \\l__listsEX_debug_bool { -2\\fboxrule }\n}\n\\__listsEX_gset_rows_num:NN\n\\g__listsEX_total_items_int\n\\l__listsEX_columns_int\n% set \\g__listsEX_current_col_num_int to 1 if at the start of a row,\n% then also step \\g__listsEX_current_row_num_int :\n\\int_compare:nNnT\n{ \\g__listsEX_current_col_num_int } > { \\l__listsEX_columns_int }\n{\n\\int_gset:Nn \\g__listsEX_current_col_num_int { 1 }\n\\int_incr:N \\g__listsEX_current_row_num_int\n}\n\\bool_if:NT \\l__listsEX_item_rest_of_line_bool\n{\n\\int_set:Nn \\l__listsEX_tmpa_int\n{ \\l__listsEX_columns_int - \\g__listsEX_current_col_num_int + 1 }\n\\int_compare:nNnTF { \\l__listsEX_item_columns_int } = { 0 }\n{\n\\int_set:Nn \\l__listsEX_tmpb_int { \\l__listsEX_tmpa_int - 1 } % 8\n}\n{\n\\int_compare:nNnTF\n{ \\l__listsEX_tmpa_int } > { \\l__listsEX_item_columns_int }\n{ \\int_set_eq:NN \\l__listsEX_tmpa_int \\l__listsEX_item_columns_int }\n{ \\int_zero:N \\l__listsEX_item_columns_int }\n\\bool_if:nT\n{\n\\l__listsEX_item_rest_of_line_bool &&\n!\\int_compare_p:nNn { \\l__listsEX_item_columns_int} = { 0 }\n}\n{\n\\int_gadd:Nn \\g__listsEX_current_col_num_int\n{ \\l__listsEX_item_columns_int -1 }\n\\int_gadd:Nn \\g__listsEX_total_items_int\n{ \\l__listsEX_item_columns_int -1 }\n}\n\\int_set:Nn \\l__listsEX_tmpb_int { \\l__listsEX_tmpa_int -1 }\n}\n\\dim_set:Nn \\l__listsEX_item_width_dim\n{\n\\l__listsEX_tmpa_int \\l__listsEX_item_width_dim\n+ \\l__listsEX_tmpb_int \\l__listsEX_column_sep_dim\n+ \\l__listsEX_tmpb_int \\l__listsEX_item_indent_dim\n\\bool_if:NT \\l__listsEX_debug_bool\n{ + \\int_eval:n { \\l__listsEX_tmpb_int * 2 } \\fboxrule }\n}\n}\n% set the item box:\n\\hcoffin_set:Nn \\l__listsEX_item_coffin\n{\n\\vcoffin_set:Nnn \\l__listsEX_tmpa_coffin\n{ \\l__listsEX_item_width_dim }\n{ \\__listsEX_setup: #2 {#3} \\strut }\n\\__listsEX_debug:n\n{\n\\coffin_typeset:Nnnnn \\l__listsEX_tmpa_coffin\n{l} {T} {0pt} {0pt}\n}\n}\n% set the label box:\n\\hcoffin_set:Nn \\l__listsEX_label_coffin\n{\n\\vcoffin_set:Nnn \\l__listsEX_tmpa_coffin\n{\n\\l__listsEX_label_width_dim\n\\bool_if:NT \\l__listsEX_debug_bool {-2\\fboxrule }\n}\n{\n\\noindent\n\\tl_use:N \\l__listsEX_item_fill_left_tl\n\\strut #1\n\\tl_use:N \\l__listsEX_item_fill_right_tl\n}\n\\__listsEX_debug:n\n{\n\\coffin_typeset:Nnnnn \\l__listsEX_tmpa_coffin\n{l} {T} {0pt} {0pt}\n}\n}\n% attach the label box at the left of the item box, shifted by\n% \\l__listsEX_label_offset_dim :\n\\coffin_attach:NnnNnnnn\n\\l__listsEX_item_coffin {l} {T}\n\\l__listsEX_label_coffin {l} {T}\n{\n\\dim_compare:nNnTF\n{ \\l__listsEX_item_indent_dim }\n<\n{ \\l__listsEX_label_offset_dim + \\l__listsEX_label_width_dim }\n{0pt}\n{ - \\l__listsEX_label_width_dim - \\l__listsEX_label_offset_dim }\n} { 0pt }\n% when a new row starts enter vertical mode:\n\\int_compare:nNnT { \\g__listsEX_current_col_num_int } = { 1 }\n{ \\skip_vertical:N \\c_zero_skip }\n% skip horizontally by \\l__listsEX_item_indent_dim\n\\noindent\n\\skip_horizontal:N \\l__listsEX_item_indent_dim\n% typeset the item (with the attached label protruding to the left):\n\\coffin_typeset:Nnnnn \\l__listsEX_item_coffin\n{l}\n{T}\n{0pt}\n{0pt}\n\\bool_if:nT\n{\n\\l__listsEX_item_full_line_bool ||\n(\n\\l__listsEX_item_rest_of_line_bool &&\n\\int_compare_p:nNn { \\l__listsEX_item_columns_int } = { 0 }\n)\n}\n{ \\listsEX_new_row: }\n% are we between items in a row? The skip by \\l__listsEX_column_sep_dim :\n\\int_compare:nNnT\n{ \\g__listsEX_current_col_num_int } < { \\l__listsEX_columns_int }\n{ \\skip_horizontal:N \\l__listsEX_column_sep_dim }\n% if we ended a row and a new row is still to come skip vertically by\n% \\l__listsEX_after_item_skip :\n\\bool_if:nT\n{\n( \\int_compare_p:nNn { \\g__listsEX_current_col_num_int } = { \\l__listsEX_columns_int } )\n&&\n( \\int_compare_p:n { \\g__listsEX_current_row_num_int != \\l__listsEX_rows_int } )\n}\n{ \\skip_vertical:N \\l__listsEX_after_item_skip }\n% clean up:\n\\coffin_clear:N \\l__listsEX_item_coffin\n\\coffin_clear:N \\l__listsEX_label_coffin\n\\coffin_clear:N \\l__listsEX_tmpa_coffin\n\\bool_set_false:N \\l__listsEX_item_full_line_bool\n\\bool_set_false:N \\l__listsEX_item_rest_of_line_bool\n}\n\\cs_generate_variant:Nn \\__listsEX_listEX:nnn { VVV }\n\n\\cs_new_protected:Npn \\__listsEX_setup:\n{\n\\dim_set:Nn \\parskip { 0pt }\n\\skip_set:Nn \\parfillskip { 0pt plus 1fil }\n\\dim_set_eq:NN \\parskip \\parsep\n\\dim_set_eq:NN \\parindent \\listparindent\n\\noindent\n\\dim_compare:nNnT\n{ \\l__listsEX_item_indent_dim }\n<\n{ \\l__listsEX_label_offset_dim + \\l__listsEX_label_width_dim }\n{\n\\skip_horizontal:n\n{\n\\l__listsEX_label_offset_dim\n+ \\l__listsEX_label_width_dim\n- \\l__listsEX_item_indent_dim\n}\n}\n\\strut\n}\n\n\\cs_new_protected:Npn \\__listsEX_gset_rows_num:NN #1#2\n{\n\\int_gset:Nn \\l__listsEX_rows_int { \\int_div_truncate:nn {#1} {#2} }\n\\int_compare:nNnT { \\int_mod:nn {#1} {#2} } > { 0 }\n{ \\int_gincr:N \\l__listsEX_rows_int }\n}\n\n\\cs_new_protected:Npn \\__listsEX_label_align:n #1\n{\n\\str_case:nnF {#1}\n{\n{left}\n{\n\\tl_clear:N \\l__listsEX_item_fill_left_tl\n\\tl_set_eq:NN \\l__listsEX_item_fill_right_tl \\hfill\n}\n{right}\n{\n\\tl_set_eq:NN \\l__listsEX_item_fill_left_tl \\hfill\n\\tl_clear:N \\l__listsEX_item_fill_right_tl\n}\n{center}\n{\n\\tl_set_eq:NN \\l__listsEX_item_fill_left_tl \\hfill\n\\tl_set_eq:NN \\l__listsEX_item_fill_right_tl \\hfill\n}\n}\n{\n\\tl_clear:N \\l__listsEX_item_fill_left_tl\n\\tl_set_eq:NN \\l__listsEX_item_fill_right_tl \\hfill\n}\n}\n\\cs_generate_variant:Nn \\__listsEX_label_align:n { V }\n\\__listsEX_label_align:n {left}\n\n% --------------------------------------------------------------------------\n% the ‘listsEX' object:\n% #1: number of items\n% #2: number of columns\n% #3: label-format\n\\DeclareObjectType {listsEX} {3}\n% the ‘default' template interface:\n\\DeclareTemplateInterface {listsEX} {default} {3}\n{\nenumerate : boolean = true ,\nlabel : tokenlist ,\nindent : length = 2.5em ,\ncounter-format : tokenlist = tsk[a]) ,\nlabel-format : tokenlist ,\nlabel-width : length = 1em ,\nlabel-offset : length = .3333em ,\nitem-format : tokenlist ,\nafter-item-skip : skip = 1ex plus 1ex minus 1ex\n}\n\n% in the next three commands we want a really unlikely to occur marker; for\n% this we use $ with unusual catcode in ‘‘$listsEX$default$label$'':\n\\cs_set:Nx \\__listsEX_restore_dollar:\n{ \\char_set_catcode:nn {36} { \\char_value_catcode:n {36} } }\n\\char_set_catcode_alignment:N \\$\n\n% the ‘default' template code:\n\\DeclareTemplateCode {listsEX} {default} {3}\n{\nenumerate = \\l__listsEX_enumerate_bool ,\nlabel = \\l__listsEX_label_tl ,\nindent = \\l__listsEX_item_default_indent_dim ,\ncounter-format = \\l__listsEX_label_pattern_tl ,\nlabel-format = \\l__listsEX_label_format_tl ,\nlabel-width = \\l__listsEX_label_default_width_dim ,\nlabel-offset = \\l__listsEX_label_default_offset_dim ,\nitem-format = \\l__listsEX_item_format_tl ,\nafter-item-skip = \\l__listsEX_after_item_skip\n}\n{\n\\AssignTemplateKeys\n\\bool_if:NF \\l__listsEX_label_width_bool\n{\n\\dim_set_eq:NN\n\\l__listsEX_label_width_dim\n\\l__listsEX_label_default_width_dim\n}\n\\bool_if:NF \\l__listsEX_item_indent_bool\n{\n\\dim_set_eq:NN\n\\l__listsEX_item_indent_dim\n\\l__listsEX_item_default_indent_dim\n}\n\\bool_if:NF \\l__listsEX_label_offset_bool\n{\n\\dim_set_eq:NN\n\\l__listsEX_label_offset_dim\n\\l__listsEX_label_default_offset_dim\n}\n\\bool_if:NT \\l__listsEX_custom_after_item_skip_bool\n{\n\\skip_set_eq:NN\n\\l__listsEX_after_item_skip\n\\l__listsEX_custom_after_item_skip\n}\n\\bool_if:NT \\l__listsEX_custom_label_bool\n{\n\\tl_set_eq:NN\n\\l__listsEX_label_tl\n\\l__listsEX_custom_label_tl\n\\bool_set_false:N \\l__listsEX_enumerate_bool\n}\n\\__listsEX_label_align:V \\l__listsEX_label_align_tl\n% need this for enumerate list:\n\\bool_if:nT { !\\l__listsEX_resume_bool && \\l__listsEX_enumerate_bool }\n{ \\int_gzero:N \\g__listsEX_int }\n\\int_set:Nn \\l__listsEX_columns_int {#2}\n% set all the items in their own coffins and join with the ground:\n\\int_gzero:N \\g__listsEX_current_col_num_int\n\\int_set:Nn \\g__listsEX_current_row_num_int {1}\n\\tl_if_blank:VF \\l__listsEX_custom_label_pattern_tl\n{\n\\tl_set_eq:NN\n\\l__listsEX_label_pattern_tl\n\\l__listsEX_custom_label_pattern_tl\n}\n\\tl_if_blank:VF \\l__listsEX_custom_label_format_tl\n{\n\\tl_set_eq:NN\n\\l__listsEX_label_format_tl\n\\l__listsEX_custom_label_format_tl\n}\n\\tl_if_blank:VF \\l__listsEX_custom_item_format_tl\n{\n\\tl_set_eq:NN\n\\l__listsEX_item_format_tl\n\\l__listsEX_custom_item_format_tl\n}\n\\seq_map_inline:Nn \\l__listsEX_seq\n{\n\\__listsEX_read_item:www ##1 \\q_stop\n\\bool_if:NTF \\l__listsEX_enumerate_bool\n{\n\\tl_if_eq:VnT \\l__listsEX_tmp_label_tl { $listsEX$default$label$ }\n{\n\\int_gincr:N \\g__listsEX_int\n\\SaveCounterPatternFrom [listsEX]\n\\l__listsEX_tmpa_tl\n\\l__listsEX_label_tl\n\\l__listsEX_label_pattern_tl\n}\n}\n{\n\\tl_if_blank:VT \\l__listsEX_label_tl\n{ \\tl_set_eq:NN \\l__listsEX_label_tl \\labelitemi }\n}\n\\tl_put_left:NV \\l__listsEX_label_tl \\l__listsEX_label_format_tl\n% \\tl_put_left:NV \\l__listsEX_item_tl \\l__listsEX_item_format_tl\n\\tl_if_eq:VnTF \\l__listsEX_tmp_label_tl { $listsEX$default$label$ }\n{\n\\__listsEX_listEX:VVV\n\\l__listsEX_label_tl\n\\l__listsEX_item_format_tl\n\\l__listsEX_item_tl\n}\n{\n\\__listsEX_listEX:VVV\n\\l__listsEX_tmp_label_tl\n\\l__listsEX_item_format_tl\n\\l__listsEX_item_tl\n\\tl_clear:N \\l__listsEX_tmp_label_tl\n}\n}\n}\n\n\\cs_new_protected:Npn \\__listsEX_read_item:www\n{\n\\peek_meaning_remove:NTF !\n{\n\\bool_set_true:N \\l__listsEX_item_full_line_bool\n\\__listsEX_read_item_aux:ww\n}\n{\n\\peek_meaning_remove:NTF *\n{\n\\bool_set_true:N \\l__listsEX_item_rest_of_line_bool\n\\__listsEX_read_item_rest_of_line:ww\n}\n{ \\__listsEX_read_item_aux:ww }\n}\n}\n\n\\cs_new_protected:Npn \\__listsEX_read_item_rest_of_line:ww\n{\n\\peek_meaning:NTF ( % )\n{ \\__listsEX_read_item_rest_of_line_aux:ww }\n{ \\__listsEX_read_item_rest_of_line_aux:ww (0) }\n}\n\n\\cs_new_protected:Npn \\__listsEX_read_item_rest_of_line_aux:ww (#1)\n{\n\\int_set:Nn \\l__listsEX_item_columns_int {#1}\n\\__listsEX_read_item_aux:ww\n}\n\n\\cs_new_protected:Npn \\__listsEX_read_item_aux:ww\n{\n\\peek_meaning:NTF [ % ]\n{ \\__listsEX_read_item_aux_ii:ww }\n{ \\__listsEX_read_item_aux_ii:ww [$listsEX$default$label$] }\n}\n\\cs_new_protected:Npn \\__listsEX_read_item_aux_ii:ww [#1]#2 \\q_stop\n{\n\\tl_set:Nn \\l__listsEX_tmp_label_tl {#1}\n\\tl_if_eq:nnF { #1 } { $listsEX$default$label$ }\n{ \\tl_put_left:NV \\l__listsEX_tmp_label_tl \\l__listsEX_label_format_tl }\n\\tl_set:Nx \\l__listsEX_item_tl { \\tl_trim_spaces:n {#2} }\n}\n\n\\__listsEX_restore_dollar:\n\n% --------------------------------------------------------------------------\n% choice box:\n\\bool_new:N \\l__listsEX_choice_checked_bool\n\\dim_new:N \\l__listsEX_choice_width_dim\n\\dim_set:Nn \\l__listsEX_choice_width_dim { 1.25ex }\n\\dim_new:N \\l__listsEX_choice_linewidth_dim\n\\dim_set:Nn \\l__listsEX_choice_linewidth_dim { .3pt }\n\\dim_new:N \\l__listsEX_choice_checkwidth_dim\n\\dim_set:Nn \\l__listsEX_choice_checkwidth_dim { .5pt }\n\\dim_new:N \\l__listsEX_choice_raise_dim\n\\dim_set:Nn \\l__listsEX_choice_raise_dim { .1ex }\n\n\\cs_new_protected:Npn \\listsEX_choice:\n{\n\\leavevmode\n\\group_begin:\n\\bool_set_false:N \\l__listsEX_choice_checked_bool\n\\box_move_up:nn\n{ \\l__listsEX_choice_raise_dim }\n{ \\hbox:n { \\__listsEX_choice: } }\n\\group_end:\n}\n\n\\cs_new_protected:Npn \\listsEX_choice_checked:\n{\n\\leavevmode\n\\group_begin:\n\\bool_set_true:N \\l__listsEX_choice_checked_bool\n\\box_move_up:nn\n{ \\l__listsEX_choice_raise_dim }\n{ \\hbox:n { \\__listsEX_choice: } }\n\\group_end:\n}\n\n\\cs_new_protected:Npn \\__listsEX_choice:\n{%\n\\dim_set:Nn \\unitlength { .1\\l__listsEX_choice_width_dim }\n\\begin{picture}(10,0)\n\\linethickness \\l__listsEX_choice_linewidth_dim\n\\drawline(0,0)(0,10)(10,10)(10,0)(0,0)\n\\linethickness \\l__listsEX_choice_checkwidth_dim\n\\bool_if:NT \\l__listsEX_choice_checked_bool\n{\n\\drawline(2,2)(8,8)\n\\drawline(2,8)(8,2)\n}\n\\end{picture}%\n}\n\n\\providecommand* \\choicebox { \\listsEX_choice: }\n\\providecommand* \\checkedchoicebox { \\listsEX_choice_checked: }\n\n% --------------------------------------------------------------------------\n% base instance:\n% ALPHABETIZE: a) b) c)\n\\DeclareInstance {listsEX} {alphabetize} {default} { }\n\n\\keys_define:nn {listsEX/list}\n{\ndebug .bool_set:N = \\l__listsEX_debug_bool ,\nstyle .tl_set:N = \\l__listsEX_instance_tl ,\nstyle .initial:n = alphabetize ,\ncounter-format .tl_set:N = \\l__listsEX_custom_label_pattern_tl ,\nlabel .code:n =\n\\bool_set_true:N \\l__listsEX_custom_label_bool\n\\tl_set:Nn \\l__listsEX_custom_label_tl {#1} ,\nlabel-format .tl_set:N = \\l__listsEX_custom_label_format_tl ,\nlabel-width .code:n =\n\\dim_set:Nn \\l__listsEX_label_width_dim {#1}\n\\bool_set_true:N \\l__listsEX_label_width_bool ,\nlabel-offset .code:n =\n\\dim_set:Nn \\l__listsEX_label_offset_dim {#1}\n\\bool_set_true:N \\l__listsEX_label_offset_bool ,\nlabel-align .tl_set:N = \\l__listsEX_label_align_tl ,\nitem-format .tl_set:N = \\l__listsEX_custom_item_format_tl ,\nitem-indent .code:n =\n\\dim_set:Nn \\l__listsEX_item_indent_dim {#1}\n\\bool_set_true:N \\l__listsEX_item_indent_bool ,\ncolumn-sep .dim_set:N = \\l__listsEX_column_sep_dim ,\nbefore-skip .skip_set:N = \\l__listsEX_before_list_skip ,\nafter-skip .skip_set:N = \\l__listsEX_after_list_skip ,\nafter-item-skip .code:n =\n\\bool_set_true:N \\l__listsEX_custom_after_item_skip_bool\n\\skip_set:Nn \\l__listsEX_custom_after_item_skip {#1} ,\nresume .bool_set:N = \\l__listsEX_resume_bool\n}\n\n% --------------------------------------------------------------------------\n% the generic environment:\n\\NewEnviron {__listsEX_env:} [3]\n{\n\\if@inlabel\n\\noindent\\par\\nobreak\\vskip-\\parskip\\vskip-\\baselineskip\\hrule\\@height\\z@\n\\fi\n\\dim_compare:nNnF { \\l__listsEX_before_list_skip } = { 0pt }\n{ \\vspace {\\l__listsEX_before_list_skip} }\n\\list {}\n{\n\\keys_set:nn {listsEX/list} {#2}\n\\dim_set:Nn \\leftmargin {0pt}\n\\dim_set:Nn \\rightmargin {0pt}\n}\n\\item \\scan_stop:\n\\int_incr:N \\l__listsEX_depth_int\n\\__listsEX:VnnV \\l__listsEX_instance_tl {#3} {#1} \\BODY\n\\endlist\n\\dim_compare:nNnF { \\l__listsEX_after_list_skip } = { 0pt }\n{ \\vspace {\\l__listsEX_after_list_skip} }\n}\n\n% --------------------------------------------------------------------------\n% command to start a new row:\n\\cs_new_protected:Npn \\listsEX_new_row:\n{\n\\int_gset:Nn \\g__listsEX_total_items_int\n{\n\\g__listsEX_total_items_int +\n\\l__listsEX_columns_int -\n\\g__listsEX_current_col_num_int\n}\n\\__listsEX_gset_rows_num:NN\n\\g__listsEX_total_items_int\n\\l__listsEX_columns_int\n\\int_gset_eq:NN \\g__listsEX_current_col_num_int \\l__listsEX_columns_int\n}\n\n\\NewDocumentCommand \\startnewitemlineEX {}\n{ \\listsEX_new_row: }\n\n% --------------------------------------------------------------------------\n% the user environment:\n\\NewDocumentCommand \\NewListsEX { O{}mO{\\listEX}D(){1} }\n{\n\\NewDocumentEnvironment {#2} { O{}D(){#4} }\n{ \\__listsEX_env: {#3} { #1,##1 } {##2} }\n{ \\end__listsEX_env: }\n}\n\n\\NewDocumentCommand \\RenewListsEX { O{}mO{\\listEX}D(){1} }\n{\n\\RenewDocumentEnvironment {#2} { O{}D(){#4} }\n{ \\__listsEX_env: {#3} { #1,##1 } {##2} }\n{ \\end__listsEX_env: }\n}\n\n% --------------------------------------------------------------------------\n% default list:\n\\NewListsEX {listsEX}\n\n\\file_if_exist:nT {listsEX.cfg} { \\file_input:n {listsEX.cfg} }\n\n% --------------------------------------------------------------------------\n% setup:\n\\cs_new_protected:Npn \\listsEX_setup:n #1\n{ \\keys_set:nn {listsEX/list} {#1} }\n\n\\NewDocumentCommand \\setlistsEX { m }\n{ \\listsEX_setup:n {#1} }\n\\newcommand{\\StartNumber}[1]{\n\\int_gset:Nn \\g__listsEX_int {#1}\n}\n%tasks\n\\NewListsEX{taskEX}[\\item]\n\\NewEnviron{listEX}[1][]{%\n\\hfill\n\\ifstrempty{#1}{%\n\\begin{enumerate}\n\\BODY\n\\end{enumerate}\n}{%\n\\def\\tempbegin{\\begin{taskEX}(#1)}%\n\\expandafter\\tempbegin\\BODY\n\\end{taskEX}\n}\n}\n\\NewEnviron{enumEX}[2][]{%\n\\hfill\n\\ifthenelse{\\equal{#2}{1}}\n{\n\\ifstrempty{#1}\n{\n\\begin{enumerate}\n\\BODY\n\\end{enumerate}\n}\n{\n\\begin{enumerate}[#1]\n\\BODY\n\\end{enumerate}}\n}\n{\n\\ifstrempty{#1}{%\n\\def\\tempbegin{\\begin{taskEX}[counter-format=tsk[a])](#2)}%\n}{%\n\\ifthenelse{\\equal{#1}{a.}}{%\n\\def\\tempbegin{\\begin{taskEX}[counter-format=tsk[a].](#2)}%\n}{\n\\ifthenelse{\\equal{#1}{(a)}}{%\n\\def\\tempbegin{\\begin{taskEX}[counter-format=(tsk[a]),label-width=1.3em](#2)}%\n}{\n\\ifthenelse{\\equal{#1}{a)}}{%\n\\def\\tempbegin{\\begin{taskEX}[counter-format=tsk[a])](#2)}%\n}{\n\\ifthenelse{\\equal{#1}{A.}}{%\n\\def\\tempbegin{\\begin{taskEX}[counter-format=tsk[A].](#2)}%\n}{\n\\ifthenelse{\\equal{#1}{(A)}}{%\n\\def\\tempbegin{\\begin{taskEX}[counter-format=(tsk[A]),label-width=1.3em](#2)}%\n}{\n\\ifthenelse{\\equal{#1}{A)}}{%\n\\def\\tempbegin{\\begin{taskEX}[counter-format=tsk[A])](#2)}%\n}{\n\\ifthenelse{\\equal{#1}{1.}}{%\n\\def\\tempbegin{\\begin{taskEX}[counter-format=tsk[1].](#2)}%\n}{\n\\ifthenelse{\\equal{#1}{(1)}}{%\n\\def\\tempbegin{\\begin{taskEX}[counter-format=(tsk[1]),label-width=1.3em](#2)}%\n}{\n\\ifthenelse{\\equal{#1}{1)}}{%\n\\def\\tempbegin{\\begin{taskEX}[counter-format=tsk[1])](#2)}%\n}{\n\\ifthenelse{\\equal{#1}{i.}}{%\n\\def\\tempbegin{\\begin{taskEX}[counter-format=tsk[r].](#2)}%\n}{\n\\ifthenelse{\\equal{#1}{(i)}}{%\n\\def\\tempbegin{\\begin{taskEX}[counter-format=(tsk[r]),label-width=1.4em](#2)}%\n}{\n\\ifthenelse{\\equal{#1}{i)}}{%\n\\def\\tempbegin{\\begin{taskEX}[counter-format=tsk[r])](#2)}%\n}{\n\\ifthenelse{\\equal{#1}{I.}}{%\n\\def\\tempbegin{\\begin{taskEX}[counter-format=tsk[R].,label-width=1.4em](#2)}%\n}{\n\\ifthenelse{\\equal{#1}{(I)}}{%\n\\def\\tempbegin{\\begin{taskEX}[counter-format=(tsk[R]),label-width=1.6em](#2)}%\n}{\n\\ifthenelse{\\equal{#1}{I)}}{%\n\\def\\tempbegin{\\begin{taskEX}[counter-format=tsk[R]),label-width=1.4em](#2)}%\n}{\n\\def\\tempbegin{\\begin{taskEX}[label=#1](#2)}%\n}}}}}}}}}}}}}}}\n}\n\\expandafter\\tempbegin\\BODY\n\\end{taskEX}\n}\n}\n\\def\\loigiaiEX{\\colorbox{yellow!30!white}{Lời\\, giải.}}\n%End of file ‘ex_test.sty'.\n\n\n\n\n\\newif\\ifshowanswer\n\\showanswerfalse\n\\let \\hideanswer\\showanswerfalse\n\\let \\showanswer\\showanswertrue\n\\renewcommand{\\TrueEX}{\\ifshowanswer\\stepcounter{dapan}{{\\color{red}\\cbox{\\textbf{\\small\\Alph{dapan}}}} \\ignorespaces}\\else\\stepcounter{dapan}{{\\color{blue}\\cbox{\\textbf{\\small\\Alph{dapan}}}} \\ignorespaces}\\fi}\n\\newif \\ifhiendapan\\hiendapanfalse\n\\renewcommand{\\colorEX}{\\ifhiendapan\\color{red}\\else\\color{black}\\fi}"
            with codecs.open('ProVip\\' + Tenthumuc + '\\ex_test.sty', 'w', 'utf8') as (g):
                g.write(ex_test)
            with codecs.open('ProVip//' + Tenthumuc + '//' + TT + '//' + Tenfile + '.tex', 'w', 'utf8') as (f):
                f.write(line)
            path='ProVip\\' + Tenthumuc + '\\' + Tenfile + '-main.tex'
            if openfile(path)=='Error':
                QMessageBox.critical(self, 'Lỗi','Lỗi mở file '+path)
            path='ProVip\\' + Tenthumuc + '\\' + TT + '\\' + Tenfile + '.tex'
            if openfile(path)=='Error':
                QMessageBox.critical(self, 'Lỗi','Lỗi mở file '+path)

    def comboToChange(self):
        if self.group1.comboTo.currentText() == 'Nhập tên khác':
            self.group1.comboTo = QLineEdit()